<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
 <head>
  <link rel="stylesheet" href="http://st.pimg.net/tucs/style.css" type="text/css" />
<style>
.styleswitch {
  text-align: right;
}
</style>


<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script type="text/javascript" src="http://st.pimg.net/tucs/js/jquery.cookie.js"></script>
<script type="text/javascript" src="http://st.pimg.net/tucs/js/sh_main.min.js"></script>
<script type="text/javascript" src="http://st.pimg.net/tucs/js/sh_perl.min.js"></script>
<script type="text/javascript" src="http://st.pimg.net/tucs/js/jquery.styleswitch.js"></script>

<link rel="stylesheet" href="http://st.pimg.net/tucs/print.css" type="text/css" media="print" />
  <link rel="alternate" type="application/rss+xml" title="RSS 1.0" href="http://search.cpan.org/uploads.rdf" />
  <link rel="search" href="http://st.pimg.net/tucs/opensearch.xml" type="application/opensearchdescription+xml" title="SearchCPAN" />
  <title>Win32::Console - search.cpan.org</title>
 <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-3528438-1']);
    _gaq.push(["_setCustomVar",2,"Distribution","Win32-Console",3]);
    _gaq.push(["_setCustomVar",5,"Release","Win32-Console-0.09",3]);
    _gaq.push(["_setCustomVar",3,"Module","Win32::Console",3]);
    _gaq.push(["_setCustomVar",1,"Author","JDB",3]);
    _gaq.push(['_trackPageview']);
  </script>
 </head>
 <body id="cpansearch">
<center><div class="logo"><a href="/"><img src="http://st.pimg.net/tucs/img/cpan_banner.png" alt="CPAN"></a></div></center>
<div class="menubar">
 <a href="/">Home</a>
&middot; <a href="/author/">Authors</a>
&middot; <a href="/recent">Recent</a>
&middot; <a href="http://log.perl.org/cpansearch/">News</a>
&middot; <a href="/mirror">Mirrors</a>
&middot; <a href="/faq.html">FAQ</a>
&middot; <a href="/feedback">Feedback</a>
</div>
<form method="get" action="/search" name="f" class="searchbox">
<input type="text" name="query" value="" size="35">
<br>in <select name="mode">
 <option value="all">All</option>
 <option value="module" >Modules</option>
 <option value="dist" >Distributions</option>
 <option value="author" >Authors</option>
</select>&nbsp;<input type="submit" value="CPAN Search">
</form>


 <a name="_top"></a>
  <div class=path>
<div id=permalink class="noprint"><a href="/perldoc?Win32::Console">permalink</a></div>
  <a href="/~jdb/">Jan Dubois</a> &gt;
  <a href="/~jdb/Win32-Console-0.09/">Win32-Console-0.09</a> &gt;
  Win32::Console
 </div>

<div class="noprint" style="float:right;align:left;width:19ex">
<a href="http://hexten.net/cpan-faces/"><img src="http://www.gravatar.com/avatar/b9464f2c68f7d9e5337623051a0b1c39?r=g&s=80&d=http%3A%2F%2Fst.pimg.net%2Ftucs%2Fimg%2Fwho.png" width=80 height=80 
style="float:right"
/></a>
<br style="clear:both"/>
<p style="text-align:right">Download:<br/> <a href="/CPAN/authors/id/J/JD/JDB/Win32-Console-0.09.tar.gz">Win32-Console-0.09.tar.gz</a></p>
<p style="text-align:right"><a href="http://deps.cpantesters.org/?module=Win32%3A%3AConsole;perl=latest">Dependencies</a></p>
<p style="text-align:right"><a href="http://www.annocpan.org/~JDB/Win32-Console-0.09/Console.pm">Annotate this POD
</a></p>
     <p style="text-align:right"><a href="http://code.google.com/p/libwin32/">Website</a></p>
<div class=box style='width:150px; float: right'>
<h1 class=t5>Related Modules</h1>
<div style="margin:2px">
<a href="/perldoc?Term%3A%3AReadKey">Term::ReadKey</a><br>
<a href="/perldoc?Win32%3A%3AGUI">Win32::GUI</a><br>
<a href="/perldoc?Win32%3A%3AProcess">Win32::Process</a><br>
<a href="/perldoc?Term%3A%3AReadLine">Term::ReadLine</a><br>
<a href="/perldoc?Win32%3A%3AAPI">Win32::API</a><br>
<a href="/perldoc?Thread%3A%3AQueue">Thread::Queue</a><br>
<a href="/perldoc?Win32%3A%3AOLE">Win32::OLE</a><br>
<a href="/perldoc?Scalar%3A%3AUtil">Scalar::Util</a><br>
<a href="/perldoc?Win32%3A%3AGuiTest">Win32::GuiTest</a><br>
<a href="/perldoc?Time%3A%3AHiRes">Time::HiRes</a><br>
<small>
<a href="http://perlmonks.org/?node=cpan+module+search&pivot=1&module=Win32%3A%3AConsole">more...</a><br>
By <a href="http://perlmonks.org/">perlmonks.org</a></small>
</div>
</div>

<div style="float:right">
<div class=box style='width:150px'>
<h1 class=t5>CPAN RT</h1>
<div style="margin:2px">
<table style="margin-left:auto;margin-right:auto">
<tr><td>New&nbsp;</td><td style="text-align:right"> 3</td></tr>
<tr><td>Open&nbsp;</td><td style="text-align:right"> 3</td></tr>
</table>
<a href="https://rt.cpan.org/Public/Dist/Display.html?Name=Win32-Console">View/Report Bugs</a><br/>
</div>
</div>

</div>
</div>
  Module Version:  0.09 &nbsp;
<span class="noprint">
  <a href="/src/JDB/Win32-Console-0.09/Console.pm">Source</a> &nbsp;
</span>
<a name="___top"></a>
<div class=pod>
<div class=toc>
<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#REFERENCE'>REFERENCE</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#Methods'>Methods</a>
    <li class='indexItem indexItem2'><a href='#Constants'>Constants</a>
    <li class='indexItem indexItem2'><a href='#Microsoft&#39;s_Documentation'>Microsoft&#39;s Documentation</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#AUTHOR'>AUTHOR</a>
  <li class='indexItem indexItem1'><a href='#CREDITS'>CREDITS</a>
  <li class='indexItem indexItem1'><a href='#DISCLAIMER'>DISCLAIMER</a>
</ul>
</div>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME <img alt='^' src='http://st.pimg.net/tucs/img/up.gif'></a></h1>

<p>Win32::Console - Win32 Console and Character Mode Functions</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION <img alt='^' src='http://st.pimg.net/tucs/img/up.gif'></a></h1>

<p>This module implements the Win32 console and character mode functions.
They give you full control on the console input and output,
including: support of off-screen console buffers (eg.
multiple screen pages)</p>

<ul>
<li>reading and writing of characters,
attributes and whole portions of the screen</li>

<li>complete processing of keyboard and mouse events</li>

<li>some very funny additional features :)</li>
</ul>

<p>Those functions should also make possible a port of the Unix&#39;s curses library; if there is anyone interested (and/or willing to contribute) to this project,
e-mail me.
Thank you.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="REFERENCE"
>REFERENCE <img alt='^' src='http://st.pimg.net/tucs/img/up.gif'></a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Methods"
>Methods</a></h2>

<dl>
<dt><a name="Alloc"
>Alloc</a></dt>

<dd>
<p>Allocates a new console for the process.
Returns <code>undef</code> on errors,
a nonzero value on success.
A process cannot be associated with more than one console,
so this method will fail if there is already an allocated console.
Use Free to detach the process from the console,
and then call Alloc to create a new console.
See also: <code>Free</code></p>

<p>Example:</p>

<pre class="sh_perl">    $CONSOLE-&#62;Alloc();</pre>

<dt><a name='Attr'></a><a name="Attr_[attr]"
>Attr [attr]</a></dt>

<dd>
<p>Gets or sets the current console attribute. This attribute is used by the Write method.</p>

<p>Example:</p>

<pre class="sh_perl">    $attr = $CONSOLE-&#62;Attr();
    $CONSOLE-&#62;Attr($FG_YELLOW | $BG_BLUE);</pre>

<dt><a name="Close"
>Close</a></dt>

<dd>
<p>Closes a shortcut object. Note that it is not &#34;strictly&#34; required to close the objects you created, since the Win32::Shortcut objects are automatically closed when the program ends (or when you elsehow destroy such an object).</p>

<p>Example:</p>

<pre class="sh_perl">    $LINK-&#62;Close();</pre>

<dt><a name='Cls'></a><a name="Cls_[attr]"
>Cls [attr]</a></dt>

<dd>
<p>Clear the console, with the specified <i>attr</i> if given, or using ATTR_NORMAL otherwise.</p>

<p>Example:</p>

<pre class="sh_perl">    $CONSOLE-&#62;Cls();
    $CONSOLE-&#62;Cls($FG_WHITE | $BG_GREEN);</pre>

<dt><a name='Cursor'></a><a name="Cursor_[x,_y,_size,_visible]"
>Cursor [x, y, size, visible]</a></dt>

<dd>
<p>Gets or sets cursor position and appearance. Returns <code>undef</code> on errors, or a 4-element list containing: <i>x</i>, <i>y</i>, <i>size</i>, <i>visible</i>. <i>x</i> and <i>y</i> are the current cursor position; ...</p>

<p>Example:</p>

<pre class="sh_perl">    ($x, $y, $size, $visible) = $CONSOLE-&#62;Cursor();

    # Get position only
    ($x, $y) = $CONSOLE-&#62;Cursor();

    $CONSOLE-&#62;Cursor(40, 13, 50, 1);

    # Set position only
    $CONSOLE-&#62;Cursor(40, 13);

    # Set size and visibility without affecting position
    $CONSOLE-&#62;Cursor(-1, -1, 50, 1);</pre>

<dt><a name="Display"
>Display</a></dt>

<dd>
<p>Displays the specified console on the screen. Returns <code>undef</code> on errors, a nonzero value on success.</p>

<p>Example:</p>

<pre class="sh_perl">    $CONSOLE-&#62;Display();</pre>

<dt><a name='FillAttr'></a><a name="FillAttr_[attribute,_number,_col,_row]"
>FillAttr [attribute, number, col, row]</a></dt>

<dd>
<p>Fills the specified number of consecutive attributes, beginning at <i>col</i>, <i>row</i>, with the value specified in <i>attribute</i>. Returns the number of attributes filled, or <code>undef</code> on errors. See also: <code>FillChar</code>.</p>

<p>Example:</p>

<pre class="sh_perl">    $CONSOLE-&#62;FillAttr($FG_BLACK | $BG_BLACK, 80*25, 0, 0);</pre>

<dt><a name='FillChar'></a><a name="FillChar_char,_number,_col,_row"
>FillChar char, number, col, row</a></dt>

<dd>
<p>Fills the specified number of consecutive characters, beginning at <i>col</i>, <i>row</i>, with the character specified in <i>char</i>. Returns the number of characters filled, or <code>undef</code> on errors. See also: <code>FillAttr</code>.</p>

<p>Example:</p>

<pre class="sh_perl">    $CONSOLE-&#62;FillChar(&#34;X&#34;, 80*25, 0, 0);</pre>

<dt><a name="Flush"
>Flush</a></dt>

<dd>
<p>Flushes the console input buffer. All the events in the buffer are discarded. Returns <code>undef</code> on errors, a nonzero value on success.</p>

<p>Example:</p>

<pre class="sh_perl">    $CONSOLE-&#62;Flush();</pre>

<dt><a name="Free"
>Free</a></dt>

<dd>
<p>Detaches the process from the console. Returns <code>undef</code> on errors, a nonzero value on success. See also: <code>Alloc</code>.</p>

<p>Example:</p>

<pre class="sh_perl">    $CONSOLE-&#62;Free();</pre>

<dt><a name='GenerateCtrlEvent'></a><a name="GenerateCtrlEvent_[type,_processgroup]"
>GenerateCtrlEvent [type, processgroup]</a></dt>

<dd>
<p>Sends a break signal of the specified <i>type</i> to the specified <i>processgroup</i>. <i>type</i> can be one of the following constants:</p>

<pre class="sh_perl">    CTRL_BREAK_EVENT
    CTRL_C_EVENT</pre>

<p>they signal, respectively, the pressing of Control + Break and of Control + C; if not specified, it defaults to CTRL_C_EVENT. <i>processgroup</i> is the pid of a process sharing the same console. If omitted, it defaults to 0 (the current process), which is also the only meaningful value that you can pass to this function. Returns <code>undef</code> on errors, a nonzero value on success.</p>

<p>Example:</p>

<pre class="sh_perl">    # break this script now
    $CONSOLE-&#62;GenerateCtrlEvent();</pre>

<dt><a name="GetEvents"
>GetEvents</a></dt>

<dd>
<p>Returns the number of unread input events in the console&#39;s input buffer, or <code>undef</code> on errors. See also: <code>Input</code>, <code>InputChar</code>, <code>PeekInput</code>, <code>WriteInput</code>.</p>

<p>Example:</p>

<pre class="sh_perl">    $events = $CONSOLE-&#62;GetEvents();</pre>

<dt><a name="Info"
>Info</a></dt>

<dd>
<p>Returns an array of informations about the console (or <code>undef</code> on errors), which contains:</p>

<ul>
<li>columns (X size) of the console buffer.</li>

<li>rows (Y size) of the console buffer.</li>

<li>current column (X position) of the cursor.</li>

<li>current row (Y position) of the cursor.</li>

<li>current attribute used for <code>Write</code>.</li>

<li>left column (X of the starting point) of the current console window.</li>

<li>top row (Y of the starting point) of the current console window.</li>

<li>right column (X of the final point) of the current console window.</li>

<li>bottom row (Y of the final point) of the current console window.</li>

<li>maximum number of columns for the console window, given the current buffer size, font and the screen size.</li>

<li>maximum number of rows for the console window, given the current buffer size, font and the screen size.</li>
</ul>

<p>See also: <code>Attr</code>, <code>Cursor</code>, <code>Size</code>, <code>Window</code>, <code>MaxWindow</code>.</p>

<p>Example:</p>

<pre class="sh_perl">    @info = $CONSOLE-&#62;Info();
    print &#34;Cursor at $info[3], $info[4].\n&#34;;</pre>

<dt><a name="Input"
>Input</a></dt>

<dd>
<p>Reads an event from the input buffer. Returns a list of values, which depending on the event&#39;s nature are:</p>

<dl>
<dt><a name='keyboard'></a><a name="keyboard_event"
>keyboard event</a></dt>

<dd>
<p>The list will contain:</p>

<ul>
<li>event type: 1 for keyboard</li>

<li>key down: TRUE if the key is being pressed, FALSE if the key is being released</li>

<li>repeat count: the number of times the key is being held down</li>

<li>virtual keycode: the virtual key code of the key</li>

<li>virtual scancode: the virtual scan code of the key</li>

<li>char: the ASCII code of the character (if the key is a character key, 0 otherwise)</li>

<li>control key state: the state of the control keys (SHIFTs, CTRLs, ALTs, etc.)</li>
</ul>

<dt><a name='mouse'></a><a name="mouse_event"
>mouse event</a></dt>

<dd>
<p>The list will contain:</p>

<ul>
<li>event type: 2 for mouse</li>

<li>mouse pos. X: X coordinate (column) of the mouse location</li>

<li>mouse pos. Y: Y coordinate (row) of the mouse location</li>

<li>button state: the mouse button(s) which are pressed</li>

<li>control key state: the state of the control keys (SHIFTs, CTRLs, ALTs, etc.)</li>

<li>event flags: the type of the mouse event</li>
</ul>
</dd>
</dl>

<p>This method will return <code>undef</code> on errors. Note that the events returned are depending on the input <code>Mode</code> of the console; for example, mouse events are not intercepted unless ENABLE_MOUSE_INPUT is specified. See also: <code>GetEvents</code>, <code>InputChar</code>, <code>Mode</code>, <code>PeekInput</code>, <code>WriteInput</code>.</p>

<p>Example:</p>

<pre class="sh_perl">    @event = $CONSOLE-&#62;Input();</pre>

<dt><a name='InputChar'></a><a name="InputChar_number"
>InputChar number</a></dt>

<dd>
<p>Reads and returns <i>number</i> characters from the console input buffer, or <code>undef</code> on errors. See also: <code>Input</code>, <code>Mode</code>.</p>

<p>Example:</p>

<pre class="sh_perl">    $key = $CONSOLE-&#62;InputChar(1);</pre>

<dt><a name='InputCP'></a><a name="InputCP_[codepage]"
>InputCP [codepage]</a></dt>

<dd>
<p>Gets or sets the input code page used by the console. Note that this doesn&#39;t apply to a console object, but to the standard input console. This attribute is used by the Write method. See also: <code>OutputCP</code>.</p>

<p>Example:</p>

<pre class="sh_perl">    $codepage = $CONSOLE-&#62;InputCP();
    $CONSOLE-&#62;InputCP(437);

    # you may want to use the non-instanciated form to avoid confuzion :)
    $codepage = Win32::Console::InputCP();
    Win32::Console::InputCP(437);</pre>

<dt><a name="MaxWindow"
>MaxWindow</a></dt>

<dd>
<p>Returns the size of the largest possible console window, based on the current font and the size of the display. The result is <code>undef</code> on errors, otherwise a 2-element list containing col, row.</p>

<p>Example:</p>

<pre class="sh_perl">    ($maxCol, $maxRow) = $CONSOLE-&#62;MaxWindow();</pre>

<dt><a name='Mode'></a><a name="Mode_[flags]"
>Mode [flags]</a></dt>

<dd>
<p>Gets or sets the input or output mode of a console. <i>flags</i> can be a combination of the following constants:</p>

<pre class="sh_perl">    ENABLE_LINE_INPUT
    ENABLE_ECHO_INPUT
    ENABLE_PROCESSED_INPUT
    ENABLE_WINDOW_INPUT
    ENABLE_MOUSE_INPUT
    ENABLE_PROCESSED_OUTPUT
    ENABLE_WRAP_AT_EOL_OUTPUT</pre>

<p>For more informations on the meaning of those flags, please refer to the <a href="#Microsoft&#39;s_Documentation" class="podlinkpod"
>&#34;Microsoft&#39;s Documentation&#34;</a>.</p>

<p>Example:</p>

<pre class="sh_perl">    $mode = $CONSOLE-&#62;Mode();
    $CONSOLE-&#62;Mode(ENABLE_MOUSE_INPUT | ENABLE_PROCESSED_INPUT);</pre>

<dt><a name="MouseButtons"
>MouseButtons</a></dt>

<dd>
<p>Returns the number of the buttons on your mouse, or <code>undef</code> on errors.</p>

<p>Example:</p>

<pre class="sh_perl">    print &#34;Your mouse has &#34;, $CONSOLE-&#62;MouseButtons(), &#34; buttons.\n&#34;;</pre>

<dt><a name='new'></a><a name="new_Win32::Console_standard_handle"
>new Win32::Console standard_handle</a></dt>

<dd>
<dt><a name='new'></a><a name="new_Win32::Console_[accessmode,_sharemode]"
>new Win32::Console [accessmode, sharemode]</a></dt>

<dd>
<p>Creates a new console object. The first form creates a handle to a standard channel, <i>standard_handle</i> can be one of the following:</p>

<pre class="sh_perl">    STD_OUTPUT_HANDLE
    STD_ERROR_HANDLE
    STD_INPUT_HANDLE</pre>

<p>The second form, instead, creates a console screen buffer in memory, which you can access for reading and writing as a normal console, and then redirect on the standard output (the screen) with <code>Display</code>. In this case, you can specify one or both of the following values for <i>accessmode</i>:</p>

<pre class="sh_perl">    GENERIC_READ
    GENERIC_WRITE</pre>

<p>which are the permissions you will have on the created buffer, and one or both of the following values for <i>sharemode</i>:</p>

<pre class="sh_perl">    FILE_SHARE_READ
    FILE_SHARE_WRITE</pre>

<p>which affect the way the console can be shared. If you don&#39;t specify any of those parameters, all 4 flags will be used.</p>

<p>Example:</p>

<pre class="sh_perl">    $STDOUT = new Win32::Console(STD_OUTPUT_HANDLE);
    $STDERR = new Win32::Console(STD_ERROR_HANDLE);
    $STDIN  = new Win32::Console(STD_INPUT_HANDLE);

    $BUFFER = new Win32::Console();
    $BUFFER = new Win32::Console(GENERIC_READ | GENERIC_WRITE);</pre>

<dt><a name='OutputCP'></a><a name="OutputCP_[codepage]"
>OutputCP [codepage]</a></dt>

<dd>
<p>Gets or sets the output code page used by the console. Note that this doesn&#39;t apply to a console object, but to the standard output console. See also: <code>InputCP</code>.</p>

<p>Example:</p>

<pre class="sh_perl">    $codepage = $CONSOLE-&#62;OutputCP();
    $CONSOLE-&#62;OutputCP(437);

    # you may want to use the non-instanciated form to avoid confuzion :)
    $codepage = Win32::Console::OutputCP();
    Win32::Console::OutputCP(437);</pre>

<dt><a name="PeekInput"
>PeekInput</a></dt>

<dd>
<p>Does exactly the same as <code>Input</code>, except that the event read is not removed from the input buffer. See also: <code>GetEvents</code>, <code>Input</code>, <code>InputChar</code>, <code>Mode</code>, <code>WriteInput</code>.</p>

<p>Example:</p>

<pre class="sh_perl">    @event = $CONSOLE-&#62;PeekInput();</pre>

<dt><a name='ReadAttr'></a><a name="ReadAttr_[number,_col,_row]"
>ReadAttr [number, col, row]</a></dt>

<dd>
<p>Reads the specified <i>number</i> of consecutive attributes, beginning at <i>col</i>, <i>row</i>, from the console. Returns the attributes read (a variable containing one character for each attribute), or <code>undef</code> on errors. You can then pass the returned variable to <code>WriteAttr</code> to restore the saved attributes on screen. See also: <code>ReadChar</code>, <code>ReadRect</code>.</p>

<p>Example:</p>

<pre class="sh_perl">    $colors = $CONSOLE-&#62;ReadAttr(80*25, 0, 0);</pre>

<dt><a name='ReadChar'></a><a name="ReadChar_[number,_col,_row]"
>ReadChar [number, col, row]</a></dt>

<dd>
<p>Reads the specified <i>number</i> of consecutive characters, beginning at <i>col</i>, <i>row</i>, from the console. Returns a string containing the characters read, or <code>undef</code> on errors. You can then pass the returned variable to <code>WriteChar</code> to restore the saved characters on screen. See also: <code>ReadAttr</code>, <code>ReadRect</code>.</p>

<p>Example:</p>

<pre class="sh_perl">    $chars = $CONSOLE-&#62;ReadChar(80*25, 0, 0);</pre>

<dt><a name='ReadRect'></a><a name="ReadRect_left,_top,_right,_bottom"
>ReadRect left, top, right, bottom</a></dt>

<dd>
<p>Reads the content (characters and attributes) of the rectangle specified by <i>left</i>, <i>top</i>, <i>right</i>, <i>bottom</i> from the console. Returns a string containing the rectangle read, or <code>undef</code> on errors. You can then pass the returned variable to <code>WriteRect</code> to restore the saved rectangle on screen (or on another console). See also: <code>ReadAttr</code>, <code>ReadChar</code>.</p>

<p>Example:</p>

<pre class="sh_perl">     $rect = $CONSOLE-&#62;ReadRect(0, 0, 80, 25);</pre>

<dt><a name='Scroll'></a><a name="Scroll_left,_top,_right,_bottom,_col,_row,_char,_attr,_[cleft,_ctop,_cright,_cbottom]"
>Scroll left, top, right, bottom, col, row, char, attr, [cleft, ctop, cright, cbottom]</a></dt>

<dd>
<p>Moves a block of data in a console buffer; the block is identified by <i>left</i>, <i>top</i>, <i>right</i>, <i>bottom</i>, while <i>row</i>, <i>col</i> identify the new location of the block. The cells left empty as a result of the move are filled with the character <i>char</i> and attribute <i>attr</i>. Optionally you can specify a clipping region with <i>cleft</i>, <i>ctop</i>, <i>cright</i>, <i>cbottom</i>, so that the content of the console outside this rectangle are unchanged. Returns <code>undef</code> on errors, a nonzero value on success.</p>

<p>Example:</p>

<pre class="sh_perl">    # scrolls the screen 10 lines down, filling with black spaces
    $CONSOLE-&#62;Scroll(0, 0, 80, 25, 0, 10, &#34; &#34;, $FG_BLACK | $BG_BLACK);</pre>

<dt><a name='Select'></a><a name="Select_standard_handle"
>Select standard_handle</a></dt>

<dd>
<p>Redirects a standard handle to the specified console. <i>standard_handle</i> can have one of the following values:</p>

<pre class="sh_perl">    STD_INPUT_HANDLE
    STD_OUTPUT_HANDLE
    STD_ERROR_HANDLE</pre>

<p>Returns <code>undef</code> on errors, a nonzero value on success.</p>

<p>Example:</p>

<pre class="sh_perl">    $CONSOLE-&#62;Select(STD_OUTPUT_HANDLE);</pre>

<dt><a name='SetIcon'></a><a name="SetIcon_icon_file"
>SetIcon icon_file</a></dt>

<dd>
<p>Sets the icon in the title bar of the current console window.</p>

<p>Example:</p>

<pre class="sh_perl">    $CONSOLE-&#62;SetIcon(&#34;C:/My/Path/To/Custom.ico&#34;);</pre>

<dt><a name='Size'></a><a name="Size_[col,_row]"
>Size [col, row]</a></dt>

<dd>
<p>Gets or sets the console buffer size.</p>

<p>Example:</p>

<pre class="sh_perl">    ($x, $y) = $CONSOLE-&#62;Size();
    $CONSOLE-&#62;Size(80, 25);</pre>

<dt><a name='Title'></a><a name="Title_[title]"
>Title [title]</a></dt>

<dd>
<p>Gets or sets the title of the current console window.</p>

<p>Example:</p>

<pre class="sh_perl">    $title = $CONSOLE-&#62;Title();
    $CONSOLE-&#62;Title(&#34;This is a title&#34;);</pre>

<dt><a name='Window'></a><a name="Window_[flag,_left,_top,_right,_bottom]"
>Window [flag, left, top, right, bottom]</a></dt>

<dd>
<p>Gets or sets the current console window size. If called without arguments, returns a 4-element list containing the current window coordinates in the form of <i>left</i>, <i>top</i>, <i>right</i>, <i>bottom</i>. To set the window size, you have to specify an additional <i>flag</i> parameter: if it is 0 (zero), coordinates are considered relative to the current coordinates; if it is non-zero, coordinates are absolute.</p>

<p>Example:</p>

<pre class="sh_perl">    ($left, $top, $right, $bottom) = $CONSOLE-&#62;Window();
    $CONSOLE-&#62;Window(1, 0, 0, 80, 50);</pre>

<dt><a name='Write'></a><a name="Write_string"
>Write string</a></dt>

<dd>
<p>Writes <i>string</i> on the console, using the current attribute, that you can set with <code>Attr</code>, and advancing the cursor as needed. This isn&#39;t so different from Perl&#39;s &#34;print&#34; statement. Returns the number of characters written or <code>undef</code> on errors. See also: <code>WriteAttr</code>, <code>WriteChar</code>, <code>WriteRect</code>.</p>

<p>Example:</p>

<pre class="sh_perl">    $CONSOLE-&#62;Write(&#34;Hello, world!&#34;);</pre>

<dt><a name='WriteAttr'></a><a name="WriteAttr_attrs,_col,_row"
>WriteAttr attrs, col, row</a></dt>

<dd>
<p>Writes the attributes in the string <i>attrs</i>, beginning at <i>col</i>, <i>row</i>, without affecting the characters that are on screen. The string attrs can be the result of a <code>ReadAttr</code> function, or you can build your own attribute string; in this case, keep in mind that every attribute is treated as a character, not a number (see example). Returns the number of attributes written or <code>undef</code> on errors. See also: <code>Write</code>, <code>WriteChar</code>, <code>WriteRect</code>.</p>

<p>Example:</p>

<pre class="sh_perl">    $CONSOLE-&#62;WriteAttr($attrs, 0, 0);

    # note the use of chr()...
    $attrs = chr($FG_BLACK | $BG_WHITE) x 80;
    $CONSOLE-&#62;WriteAttr($attrs, 0, 0);</pre>

<dt><a name='WriteChar'></a><a name="WriteChar_chars,_col,_row"
>WriteChar chars, col, row</a></dt>

<dd>
<p>Writes the characters in the string <i>attr</i>, beginning at <i>col</i>, <i>row</i>, without affecting the attributes that are on screen. The string <i>chars</i> can be the result of a <code>ReadChar</code> function, or a normal string. Returns the number of characters written or <code>undef</code> on errors. See also: <code>Write</code>, <code>WriteAttr</code>, <code>WriteRect</code>.</p>

<p>Example:</p>

<pre class="sh_perl">    $CONSOLE-&#62;WriteChar(&#34;Hello, worlds!&#34;, 0, 0);</pre>

<dt><a name='WriteInput'></a><a name="WriteInput_(event)"
>WriteInput (event)</a></dt>

<dd>
<p>Pushes data in the console input buffer. <i>(event)</i> is a list of values, for more information see <code>Input</code>. The string chars can be the result of a <code>ReadChar</code> function, or a normal string. Returns the number of characters written or <code>undef</code> on errors. See also: <code>Write</code>, <code>WriteAttr</code>, <code>WriteRect</code>.</p>

<p>Example:</p>

<pre class="sh_perl">    $CONSOLE-&#62;WriteInput(@event);</pre>

<dt><a name='WriteRect'></a><a name="WriteRect_rect,_left,_top,_right,_bottom"
>WriteRect rect, left, top, right, bottom</a></dt>

<dd>
<p>Writes a rectangle of characters and attributes (contained in <i>rect</i>) on the console at the coordinates specified by <i>left</i>, <i>top</i>, <i>right</i>, <i>bottom</i>. <i>rect</i> can be the result of a <code>ReadRect</code> function. Returns <code>undef</code> on errors, otherwise a 4-element list containing the coordinates of the affected rectangle, in the format <i>left</i>, <i>top</i>, <i>right</i>, <i>bottom</i>. See also: <code>Write</code>, <code>WriteAttr</code>, <code>WriteChar</code>.</p>

<p>Example:</p>

<pre class="sh_perl">    $CONSOLE-&#62;WriteRect($rect, 0, 0, 80, 25);</pre>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Constants"
>Constants</a></h2>

<p>The following constants are exported in the main namespace of your script using Win32::Console:</p>

<pre class="sh_perl">    BACKGROUND_BLUE
    BACKGROUND_GREEN
    BACKGROUND_INTENSITY
    BACKGROUND_RED
    CAPSLOCK_ON
    CONSOLE_TEXTMODE_BUFFER
    ENABLE_ECHO_INPUT
    ENABLE_LINE_INPUT
    ENABLE_MOUSE_INPUT
    ENABLE_PROCESSED_INPUT
    ENABLE_PROCESSED_OUTPUT
    ENABLE_WINDOW_INPUT
    ENABLE_WRAP_AT_EOL_OUTPUT
    ENHANCED_KEY
    FILE_SHARE_READ
    FILE_SHARE_WRITE
    FOREGROUND_BLUE
    FOREGROUND_GREEN
    FOREGROUND_INTENSITY
    FOREGROUND_RED
    LEFT_ALT_PRESSED
    LEFT_CTRL_PRESSED
    NUMLOCK_ON
    GENERIC_READ
    GENERIC_WRITE
    RIGHT_ALT_PRESSED
    RIGHT_CTRL_PRESSED
    SCROLLLOCK_ON
    SHIFT_PRESSED
    STD_INPUT_HANDLE
    STD_OUTPUT_HANDLE
    STD_ERROR_HANDLE</pre>

<p>Additionally, the following variables can be used:</p>

<pre class="sh_perl">    $FG_BLACK
    $FG_GRAY
    $FG_BLUE
    $FG_LIGHTBLUE
    $FG_RED
    $FG_LIGHTRED
    $FG_GREEN
    $FG_LIGHTGREEN
    $FG_MAGENTA
    $FG_LIGHTMAGENTA
    $FG_CYAN
    $FG_LIGHTCYAN
    $FG_BROWN
    $FG_YELLOW
    $FG_LIGHTGRAY
    $FG_WHITE

    $BG_BLACK
    $BG_GRAY
    $BG_BLUE
    $BG_LIGHTBLUE
    $BG_RED
    $BG_LIGHTRED
    $BG_GREEN
    $BG_LIGHTGREEN
    $BG_MAGENTA
    $BG_LIGHTMAGENTA
    $BG_CYAN
    $BG_LIGHTCYAN
    $BG_BROWN
    $BG_YELLOW
    $BG_LIGHTGRAY
    $BG_WHITE

    $ATTR_NORMAL
    $ATTR_INVERSE</pre>

<p>ATTR_NORMAL is set to gray foreground on black background (DOS&#39;s standard colors).</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Microsoft&#39;s_Documentation"
>Microsoft&#39;s Documentation</a></h2>

<p>Documentation for the Win32 Console and Character mode Functions can be found on Microsoft&#39;s site at this URL:</p>

<p><a href="http://www.microsoft.com/msdn/sdk/platforms/doc/sdk/win32/sys/src/conchar.htm" class="podlinkurl"
>http://www.microsoft.com/msdn/sdk/platforms/doc/sdk/win32/sys/src/conchar.htm</a></p>

<p>A reference of the available functions is at:</p>

<p><a href="http://www.microsoft.com/msdn/sdk/platforms/doc/sdk/win32/sys/src/conchar_34.htm" class="podlinkurl"
>http://www.microsoft.com/msdn/sdk/platforms/doc/sdk/win32/sys/src/conchar_34.htm</a></p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR"
>AUTHOR <img alt='^' src='http://st.pimg.net/tucs/img/up.gif'></a></h1>

<p>Aldo Calpini &#60;a.calpini@romagiubileo.it&#62;</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="CREDITS"
>CREDITS <img alt='^' src='http://st.pimg.net/tucs/img/up.gif'></a></h1>

<p>Thanks to: Jesse Dougherty, Dave Roth, ActiveWare, and the Perl-Win32-Users community.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DISCLAIMER"
>DISCLAIMER <img alt='^' src='http://st.pimg.net/tucs/img/up.gif'></a></h1>

<p>This program is FREE; you can redistribute, modify, disassemble, or even reverse engineer this software at your will. Keep in mind, however, that NOTHING IS GUARANTEED to work and everything you do is AT YOUR OWN RISK - I will not take responsibility for any damage, loss of money and/or health that may arise from the use of this program!</p>

<p>This is distributed under the terms of Larry Wall&#39;s Artistic License.</p>

</div>
<!-- This should probably be put in the <div class="footer"></div> -->
<script type="text/javascript">
    $(document).ready(function(){
        var startingStyle = $.cookie('css') ? $.cookie('css') : 'http://st.pimg.net/tucs/css/sh_none.min.css';
        $.fn.styleSwitch(startingStyle);
        $("#styleswitch").val(startingStyle);
        sh_highlightDocument();
        $("#styleswitch").bind(($.browser.msie ? "click" : "change"), function() {
            $.fn.styleSwitch($(this).val());
        });
    });
</script>
<div class="styleswitch">
    syntax highlighting:
    <select id="styleswitch">
        <option value="http://st.pimg.net/tucs/css/sh_none.min.css">no syntax highlighting</option>
        <option value="http://st.pimg.net/tucs/css/sh_acid.min.css">acid</option>
        <option value="http://st.pimg.net/tucs/css/sh_berries-dark.min.css">berries-dark</option>
        <option value="http://st.pimg.net/tucs/css/sh_berries-light.min.css">berries-light</option>
        <option value="http://st.pimg.net/tucs/css/sh_bipolar.min.css">bipolar</option>
        <option value="http://st.pimg.net/tucs/css/sh_blacknblue.min.css">blacknblue</option>
        <option value="http://st.pimg.net/tucs/css/sh_bright.min.css">bright</option>
        <option value="http://st.pimg.net/tucs/css/sh_contrast.min.css">contrast</option>
        <option value="http://st.pimg.net/tucs/css/sh_cpan.min.css">cpan</option>
        <option value="http://st.pimg.net/tucs/css/sh_darkblue.min.css">darkblue</option>
        <option value="http://st.pimg.net/tucs/css/sh_darkness.min.css">darkness</option>
        <option value="http://st.pimg.net/tucs/css/sh_desert.min.css">desert</option>
        <option value="http://st.pimg.net/tucs/css/sh_dull.min.css">dull</option>
        <option value="http://st.pimg.net/tucs/css/sh_easter.min.css">easter</option>
        <option value="http://st.pimg.net/tucs/css/sh_emacs.min.css">emacs</option>
        <option value="http://st.pimg.net/tucs/css/sh_golden.min.css">golden</option>
        <option value="http://st.pimg.net/tucs/css/sh_greenlcd.min.css">greenlcd</option>
        <option value="http://st.pimg.net/tucs/css/sh_ide-anjuta.min.css">ide-anjuta</option>
        <option value="http://st.pimg.net/tucs/css/sh_ide-codewarrior.min.css">ide-codewarrior</option>
        <option value="http://st.pimg.net/tucs/css/sh_ide-devcpp.min.css">ide-devcpp</option>
        <option value="http://st.pimg.net/tucs/css/sh_ide-eclipse.min.css">ide-eclipse</option>
        <option value="http://st.pimg.net/tucs/css/sh_ide-kdev.min.css">ide-kdev</option>
        <option value="http://st.pimg.net/tucs/css/sh_ide-msvcpp.min.css">ide-msvcpp</option>
        <option value="http://st.pimg.net/tucs/css/sh_kwrite.min.css">kwrite</option>
        <option value="http://st.pimg.net/tucs/css/sh_matlab.min.css">matlab</option>
        <option value="http://st.pimg.net/tucs/css/sh_navy.min.css">navy</option>
        <option value="http://st.pimg.net/tucs/css/sh_nedit.min.css">nedit</option>
        <option value="http://st.pimg.net/tucs/css/sh_neon.min.css">neon</option>
        <option value="http://st.pimg.net/tucs/css/sh_night.min.css">night</option>
        <option value="http://st.pimg.net/tucs/css/sh_pablo.min.css">pablo</option>
        <option value="http://st.pimg.net/tucs/css/sh_peachpuff.min.css">peachpuff</option>
        <option value="http://st.pimg.net/tucs/css/sh_print.min.css">print</option>
        <option value="http://st.pimg.net/tucs/css/sh_rand01.min.css">rand01</option>
	<option value="http://st.pimg.net/tucs/css/sh_solarized-dark.min.css">solarized-dark</option>
	<option value="http://st.pimg.net/tucs/css/sh_solarized-light.min.css">solarized-light</option>
        <option value="http://st.pimg.net/tucs/css/sh_style.min.css">style</option>
        <option value="http://st.pimg.net/tucs/css/sh_the.min.css">the</option>
        <option value="http://st.pimg.net/tucs/css/sh_typical.min.css">typical</option>
        <option value="http://st.pimg.net/tucs/css/sh_vampire.min.css">vampire</option>
        <option value="http://st.pimg.net/tucs/css/sh_vim-dark.min.css">vim-dark</option>
        <option value="http://st.pimg.net/tucs/css/sh_vim.min.css">vim</option>
        <option value="http://st.pimg.net/tucs/css/sh_whatis.min.css">whatis</option>
        <option value="http://st.pimg.net/tucs/css/sh_whitengrey.min.css">whitengrey</option>
        <option value="http://st.pimg.net/tucs/css/sh_zellner.min.css">zellner</option>
    </select>
</div>



<div class="footer"><div class="cpanstats">78068 Uploads, 24686 Distributions
105902 Modules, 9637 Uploaders
</div>
hosted by <a href="http://www.yellowbot.com">YellowBot</a><br/>
<a href="http://www.yellowbot.com"><img alt="do. tag. write. share." src="http://st.pimg.net/tucs/img/yellowbot_logo.gif"></a>
</div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript" src="http://ipv4.v6test.develooper.com/js/v1/v6test.js"></script>

<script type="text/javascript">
   // v6.target = '';
   if (!v6.target) { v6.only_once = true }
   v6.site = '7A0D89A6-2B82-11DF-B9DA-F61CBD13F020';
   v6.api_server = 'http://ipv4.v6test.develooper.com';
   try {
     v6.test();
   } catch(err) {}
</script>
<script type="text/javascript">
  $(document).ready(function(){
    $("a[href^=http:]").click(function(){
      var href = $(this).attr('href');
      var m = href.match('\/\/([^\/:]+)');
      _gaq.push(['_trackEvent','External',m[1],'Module']);
    });
    $("a[href^=/CPAN/]").click(function(){
      var href = $(this).attr('href');
      _gaq.push(['_trackEvent','Download',href,'Module']);
    });
  });
</script>
<!-- Sun Apr 22 10:59:16 2012 GMT (0.270039081573486) @cpansearch1 -->
 </body>
</html>
