<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
 <head>
  <link rel="stylesheet" href="http://st.pimg.net/tucs/style.css" type="text/css" />
<style>
.styleswitch {
  text-align: right;
}
</style>


<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script type="text/javascript" src="http://st.pimg.net/tucs/js/jquery.cookie.js"></script>
<script type="text/javascript" src="http://st.pimg.net/tucs/js/sh_main.min.js"></script>
<script type="text/javascript" src="http://st.pimg.net/tucs/js/sh_perl.min.js"></script>
<script type="text/javascript" src="http://st.pimg.net/tucs/js/jquery.styleswitch.js"></script>

<link rel="stylesheet" href="http://st.pimg.net/tucs/print.css" type="text/css" media="print" />
  <link rel="alternate" type="application/rss+xml" title="RSS 1.0" href="http://search.cpan.org/uploads.rdf" />
  <link rel="search" href="http://st.pimg.net/tucs/opensearch.xml" type="application/opensearchdescription+xml" title="SearchCPAN" />
  <title>Devel::SmallProf - search.cpan.org</title>
 <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-3528438-1']);
    _gaq.push(["_setCustomVar",2,"Distribution","Devel-SmallProf",3]);
    _gaq.push(["_setCustomVar",5,"Release","Devel-SmallProf-2.02",3]);
    _gaq.push(["_setCustomVar",3,"Module","Devel::SmallProf",3]);
    _gaq.push(["_setCustomVar",1,"Author","SALVA",3]);
    _gaq.push(['_trackPageview']);
  </script>
 </head>
 <body id="cpansearch">
<center><div class="logo"><a href="/"><img src="http://st.pimg.net/tucs/img/cpan_banner.png" alt="CPAN"></a></div></center>
<div class="menubar">
 <a href="/">Home</a>
&middot; <a href="/author/">Authors</a>
&middot; <a href="/recent">Recent</a>
&middot; <a href="http://log.perl.org/cpansearch/">News</a>
&middot; <a href="/mirror">Mirrors</a>
&middot; <a href="/faq.html">FAQ</a>
&middot; <a href="/feedback">Feedback</a>
</div>
<form method="get" action="/search" name="f" class="searchbox">
<input type="text" name="query" value="" size="35">
<br>in <select name="mode">
 <option value="all">All</option>
 <option value="module" >Modules</option>
 <option value="dist" >Distributions</option>
 <option value="author" >Authors</option>
</select>&nbsp;<input type="submit" value="CPAN Search">
</form>


 <a name="_top"></a>
  <div class=path>
<div id=permalink class="noprint"><a href="/perldoc?Devel::SmallProf">permalink</a></div>
  <a href="/~salva/">Salvador Fandi&ntilde;o Garc&iacute;a</a> &gt;
  <a href="/~salva/Devel-SmallProf-2.02/">Devel-SmallProf-2.02</a> &gt;
  Devel::SmallProf
 </div>

<div class="noprint" style="float:right;align:left;width:19ex">
<a href="http://hexten.net/cpan-faces/"><img src="http://www.gravatar.com/avatar/026f1493e8fcd16015467901fa76e9ec?r=g&s=80&d=http%3A%2F%2Fst.pimg.net%2Ftucs%2Fimg%2Fwho.png" width=80 height=80 
style="float:right"
/></a>
<br style="clear:both"/>
<p style="text-align:right">Download:<br/> <a href="/CPAN/authors/id/S/SA/SALVA/Devel-SmallProf-2.02.tar.gz">Devel-SmallProf-2.02.tar.gz</a></p>
<p style="text-align:right"><a href="http://deps.cpantesters.org/?module=Devel%3A%3ASmallProf;perl=latest">Dependencies</a></p>
<p style="text-align:right"><a href="http://www.annocpan.org/~SALVA/Devel-SmallProf-2.02/lib/Devel/SmallProf.pm">Annotate this POD
(1)
</a></p>
<div class=box style='width:150px; float: right'>
<h1 class=t5>Related Modules</h1>
<div style="margin:2px">
<a href="/perldoc?Devel%3A%3ADProf">Devel::DProf</a><br>
<a href="/perldoc?Time%3A%3AHiRes">Time::HiRes</a><br>
<a href="/perldoc?Data%3A%3ADumper">Data::Dumper</a><br>
<a href="/perldoc?Inline%3A%3AC">Inline::C</a><br>
<a href="/perldoc?Devel%3A%3ACover">Devel::Cover</a><br>
<a href="/perldoc?Apache%3A%3ARegistry">Apache::Registry</a><br>
<a href="/perldoc?Benchmark%3A%3ATimer">Benchmark::Timer</a><br>
<a href="/perldoc?LWP%3A%3ASimple">LWP::Simple</a><br>
<a href="/perldoc?HTML%3A%3ATemplate">HTML::Template</a><br>
<a href="/perldoc?CGI%3A%3ACarp">CGI::Carp</a><br>
<small>
<a href="http://perlmonks.org/?node=cpan+module+search&pivot=1&module=Devel%3A%3ASmallProf">more...</a><br>
By <a href="http://perlmonks.org/">perlmonks.org</a></small>
</div>
</div>

<div style="float:right">
<div class=box style='width:150px'>
<h1 class=t5>CPAN RT</h1>
<div style="margin:2px">
<table style="margin-left:auto;margin-right:auto">
<tr><td>Open&nbsp;</td><td style="text-align:right"> 1</td></tr>
</table>
<a href="https://rt.cpan.org/Public/Dist/Display.html?Name=Devel-SmallProf">View/Report Bugs</a><br/>
</div>
</div>

</div>
</div>
  Module Version:  2.02 &nbsp;
<span class="noprint">
  <a href="/src/SALVA/Devel-SmallProf-2.02/lib/Devel/SmallProf.pm">Source</a> &nbsp;
</span>
<a name="___top"></a>
<div class=pod>
<div class=toc>
<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#NOTES'>NOTES</a>
  <li class='indexItem indexItem1'><a href='#OPTIONS'>OPTIONS</a>
  <li class='indexItem indexItem1'><a href='#INSTALLATION'>INSTALLATION</a>
  <li class='indexItem indexItem1'><a href='#BUGS'>BUGS</a>
  <li class='indexItem indexItem1'><a href='#EMACS/XEMACS_HACK'>EMACS/XEMACS HACK</a>
  <li class='indexItem indexItem1'><a href='#AUTHOR'>AUTHOR</a>
  <li class='indexItem indexItem1'><a href='#COPYRIGHT_AND_LICENSE'>COPYRIGHT AND LICENSE</a>
  <li class='indexItem indexItem1'><a href='#SEE_ALSO'>SEE ALSO</a>
</ul>
</div>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME <img alt='^' src='http://st.pimg.net/tucs/img/up.gif'></a></h1>

<p>Devel::SmallProf - per-line Perl profiler</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS <img alt='^' src='http://st.pimg.net/tucs/img/up.gif'></a></h1>

<pre class="sh_perl">        perl5 -d:SmallProf test.pl</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION <img alt='^' src='http://st.pimg.net/tucs/img/up.gif'></a></h1>

<p>The Devel::SmallProf profiler is focused on the time taken for a program run on a line-by-line basis. It is intended to be as &#34;small&#34; in terms of impact on the speed and memory usage of the profiled program as possible and also in terms of being simple to use. Those statistics are placed in the file <em>smallprof.out</em> in the following format:</p>

<pre class="sh_perl">        &#60;num&#62; &#60;time&#62; &#60;ctime&#62; &#60;line&#62;:&#60;text&#62;</pre>

<p>where &#60;num&#62; is the number of times that the line was executed, &#60;time&#62; is the amount of &#34;wall time&#34; (time according the the clock on the wall vs. cpu time) spent executing it, &#60;ctime&#62; is the amount of cpu time expended on it and &#60;line&#62; and &#60;text&#62; are the line number and the actual text of the executed line (read from the file).</p>

<p>The package uses the debugging hooks in Perl and thus needs the <b>-d</b> switch, so to profile <em>test.pl</em>, use the command:</p>

<pre class="sh_perl">        perl5 -d:SmallProf test.pl</pre>

<p>Once the script is done, the statistics in <em>smallprof.out</em> can be sorted to show which lines took the most time. The output can be sorted to find which lines take the longest, either with the sort command:</p>

<pre class="sh_perl">        sort -k 2nr,2 smallprof.out | less</pre>

<p>or a perl script:</p>

<pre class="sh_perl">        open(PROF,&#34;smallprof.out&#34;);
        @sorted = sort {(split(/\s+/,$b))[2] &#60;=&#62; 
                        (split(/\s+/,$a))[2]} &#60;PROF&#62;;
        close PROF;
        print join(&#39;&#39;,@sorted);</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NOTES"
>NOTES <img alt='^' src='http://st.pimg.net/tucs/img/up.gif'></a></h1>

<ul>
<li>The &#34;wall time&#34; readings come from Time::HiRes and are reasonably useful, at least on my system. The cpu times come from the &#39;times&#39; built-in and the granularity is not necessarily as small as with the wall time. On some systems this column may be useful. On others it may not.</li>

<li>SmallProf does attempt to make up for its shortcomings by subtracting a small amount from each timing (null time compensation). This should help somewhat with the accuracy.</li>

<li>SmallProf depends on the Time::HiRes package to do its timings. It claims to require version 1.20, but may work with earlier versions, depending on your platform.</li>
</ul>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="OPTIONS"
>OPTIONS <img alt='^' src='http://st.pimg.net/tucs/img/up.gif'></a></h1>

<p>SmallProf has 4 variables which can be used during your script to affect what gets profiled.</p>

<dl>
<dt><a name='DB'></a><a name="$DB::drop_zeros_(z)"
><code>$DB::drop_zeros</code> (z)</a></dt>

<dd>
<p>If you do not wish to see lines which were never called, set the variable <code>$DB::drop_zeros = 1</code>. With <code>drop_zeros</code> set, SmallProf can be used for basic coverage analysis.</p>

<dt><a name='DB'></a><a name="$DB::profile_(p)"
><code>$DB::profile</code> (p)</a></dt>

<dd>
<p>To turn off profiling for a time, insert a <code>$DB::profile = 0</code> into your code (profiling may be turned back on with <code>$DB::profile = 1</code>). All of the time between profiling being turned off and back on again will be lumped together and reported on the <code>$DB::profile = 0</code> line. This can be used to summarize a subroutine call or a chunk of code.</p>

<dt><a name='DB'></a><a name="%DB::packages"
><code>%DB::packages</code></a></dt>

<dd>
<p>To only profile code in a certain package, set the <code>%DB::packages</code> array. For example, to see only the code in packages <code>main</code> and <code>Test1</code>, do this:</p>

<pre class="sh_perl">        %DB::packages = ( &#39;main&#39; =&#62; 1, &#39;Test1&#39; =&#62; 1 );</pre>

<dt><a name='DB'></a><a name="$DB::grep_format_(g)"
><code>$DB::grep_format</code> (g)</a></dt>

<dd>
<p>Generates output on a format similar to grep easily parseable from tools like Emacs (see below).</p>

<p>grep format output appears as:</p>

<pre class="sh_perl">  file name : line num : count : time : ctime : source</pre>

<p>or</p>

<pre class="sh_perl">  file name : line num : count : time : ctime : (eval n: line num) source</pre>

<p>for code inside evals.</p>

<p>Times appear in miliseconds.</p>
</dd>
</dl>

<p>These variables can be put in a file called <em>.smallprof</em> in the current directory. For example, a <em>.smallprof</em> containing</p>

<pre class="sh_perl">        $DB::drop_zeros = 1;
        $DB::profile = 0;</pre>

<p>will set SmallProf to not report lines which are never touched for any file profiled in that directory and will set profiling off initially (presumably to be turned on only for a small portion of code).</p>

<p>Environment variable <code>SMALLPROF_CONFIG</code> can be also used to set those flags, i.e:</p>

<pre class="sh_perl">   SMALLPROF_CONFIG=zg perl -d:SmallProf my_script.plx</pre>

<p>activates <code>drop_zeros</code> and <code>grep_format</code> modes.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="INSTALLATION"
>INSTALLATION <img alt='^' src='http://st.pimg.net/tucs/img/up.gif'></a></h1>

<p>Just the usual</p>

<pre class="sh_perl">        perl Makefile.PL
        make
        make test
        make install</pre>

<p>and should install fine via the CPAN module.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="BUGS"
>BUGS <img alt='^' src='http://st.pimg.net/tucs/img/up.gif'></a></h1>

<p>Subroutine calls are currently not under the control of %DB::packages. This should not be a great inconvenience in general.</p>

<p>The handling of evals is bad news. This is due to Perl&#39;s handling of evals under the <b>-d</b> flag. For certain evals, caller() returns &#39;(eval n)&#39; for the filename and for others it doesn&#39;t. For some of those which it does, the array <code>@{&#39;_&#60;filename&#39;}</code> contains the code of the eval. For others it doesn&#39;t. Sometime, when I&#39;ve an extra tuit or two, I&#39;ll figure out why and how I can compensate for this. (Note: 5.6.0 made some debugging changes. This may now be fixed, I&#39;m not sure).</p>

<p>SmallProf must be invoked from the command line. If it is included on the shebang line, the file in which it is included will not be visible in the symbol table. Profiling will continue as expected, but the contents of the source lines will not be listed. This is new as of 5.6.0.</p>

<p>Comments, advice and questions are welcome. If you see inefficent stuff in this module and have a better way, please let me know.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="EMACS/XEMACS_HACK"
>EMACS/XEMACS HACK <img alt='^' src='http://st.pimg.net/tucs/img/up.gif'></a></h1>

<ol>
<li>Use the <code>DB::grep_format</code> flag to turn on grep like format, i.e.
<pre class="sh_perl">  SMALLPROF_CONFIG=g perl -d:SmallProf myscript.pl</pre>
</li>

<li>Tell Emacs/XEmacs to read smallprof.out as grep output:
<pre class="sh_perl">  M-x grep RET C-a C-k cat smallprof.out RET</pre>
</li>

<li>Point and click to go to the script hot spots!</li>
</ol>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR"
>AUTHOR <img alt='^' src='http://st.pimg.net/tucs/img/up.gif'></a></h1>

<p>Devel::SmallProf was developed by Ted Ashton &#60;ashted@cpan.org&#62;. It is currently being maintained by Salvador Fandi&#241;o &#60;sfandino@yahoo.com&#62;.</p>

<p>SmallProf was developed from code originally posted to usenet by Philippe Verdret &#60;philippe.verdret@sonovision-itep.fr&#62;. Special thanks to Geoffrey Broadwell &#60;habusan2@sprynet.com&#62; for his assistance on the Win32 platform and to Philippe for his patient assistance in testing and debugging.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="COPYRIGHT_AND_LICENSE"
>COPYRIGHT AND LICENSE <img alt='^' src='http://st.pimg.net/tucs/img/up.gif'></a></h1>

<p>Copyright (c) 1997-2000 Ted Ashton</p>

<p>Copyright (c) 2003-2007 Salvador Fandi&#241;o</p>

<p>This module is free software and can be redistributed and/or modified under the same terms as Perl itself.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SEE_ALSO"
>SEE ALSO <img alt='^' src='http://st.pimg.net/tucs/img/up.gif'></a></h1>

<p><a href="/perldoc?Devel%3A%3AFastProf" class="podlinkpod"
>Devel::FastProf</a> is a simplified and much faster version of this module.</p>

<p><a href="/perldoc?Devel%3A%3ADProf" class="podlinkpod"
>Devel::DProf</a>, <a href="/perldoc?Time%3A%3AHiRes" class="podlinkpod"
>Time::HiRes</a>.</p>

</div>
<!-- This should probably be put in the <div class="footer"></div> -->
<script type="text/javascript">
    $(document).ready(function(){
        var startingStyle = $.cookie('css') ? $.cookie('css') : 'http://st.pimg.net/tucs/css/sh_none.min.css';
        $.fn.styleSwitch(startingStyle);
        $("#styleswitch").val(startingStyle);
        sh_highlightDocument();
        $("#styleswitch").bind(($.browser.msie ? "click" : "change"), function() {
            $.fn.styleSwitch($(this).val());
        });
    });
</script>
<div class="styleswitch">
    syntax highlighting:
    <select id="styleswitch">
        <option value="http://st.pimg.net/tucs/css/sh_none.min.css">no syntax highlighting</option>
        <option value="http://st.pimg.net/tucs/css/sh_acid.min.css">acid</option>
        <option value="http://st.pimg.net/tucs/css/sh_berries-dark.min.css">berries-dark</option>
        <option value="http://st.pimg.net/tucs/css/sh_berries-light.min.css">berries-light</option>
        <option value="http://st.pimg.net/tucs/css/sh_bipolar.min.css">bipolar</option>
        <option value="http://st.pimg.net/tucs/css/sh_blacknblue.min.css">blacknblue</option>
        <option value="http://st.pimg.net/tucs/css/sh_bright.min.css">bright</option>
        <option value="http://st.pimg.net/tucs/css/sh_contrast.min.css">contrast</option>
        <option value="http://st.pimg.net/tucs/css/sh_cpan.min.css">cpan</option>
        <option value="http://st.pimg.net/tucs/css/sh_darkblue.min.css">darkblue</option>
        <option value="http://st.pimg.net/tucs/css/sh_darkness.min.css">darkness</option>
        <option value="http://st.pimg.net/tucs/css/sh_desert.min.css">desert</option>
        <option value="http://st.pimg.net/tucs/css/sh_dull.min.css">dull</option>
        <option value="http://st.pimg.net/tucs/css/sh_easter.min.css">easter</option>
        <option value="http://st.pimg.net/tucs/css/sh_emacs.min.css">emacs</option>
        <option value="http://st.pimg.net/tucs/css/sh_golden.min.css">golden</option>
        <option value="http://st.pimg.net/tucs/css/sh_greenlcd.min.css">greenlcd</option>
        <option value="http://st.pimg.net/tucs/css/sh_ide-anjuta.min.css">ide-anjuta</option>
        <option value="http://st.pimg.net/tucs/css/sh_ide-codewarrior.min.css">ide-codewarrior</option>
        <option value="http://st.pimg.net/tucs/css/sh_ide-devcpp.min.css">ide-devcpp</option>
        <option value="http://st.pimg.net/tucs/css/sh_ide-eclipse.min.css">ide-eclipse</option>
        <option value="http://st.pimg.net/tucs/css/sh_ide-kdev.min.css">ide-kdev</option>
        <option value="http://st.pimg.net/tucs/css/sh_ide-msvcpp.min.css">ide-msvcpp</option>
        <option value="http://st.pimg.net/tucs/css/sh_kwrite.min.css">kwrite</option>
        <option value="http://st.pimg.net/tucs/css/sh_matlab.min.css">matlab</option>
        <option value="http://st.pimg.net/tucs/css/sh_navy.min.css">navy</option>
        <option value="http://st.pimg.net/tucs/css/sh_nedit.min.css">nedit</option>
        <option value="http://st.pimg.net/tucs/css/sh_neon.min.css">neon</option>
        <option value="http://st.pimg.net/tucs/css/sh_night.min.css">night</option>
        <option value="http://st.pimg.net/tucs/css/sh_pablo.min.css">pablo</option>
        <option value="http://st.pimg.net/tucs/css/sh_peachpuff.min.css">peachpuff</option>
        <option value="http://st.pimg.net/tucs/css/sh_print.min.css">print</option>
        <option value="http://st.pimg.net/tucs/css/sh_rand01.min.css">rand01</option>
	<option value="http://st.pimg.net/tucs/css/sh_solarized-dark.min.css">solarized-dark</option>
	<option value="http://st.pimg.net/tucs/css/sh_solarized-light.min.css">solarized-light</option>
        <option value="http://st.pimg.net/tucs/css/sh_style.min.css">style</option>
        <option value="http://st.pimg.net/tucs/css/sh_the.min.css">the</option>
        <option value="http://st.pimg.net/tucs/css/sh_typical.min.css">typical</option>
        <option value="http://st.pimg.net/tucs/css/sh_vampire.min.css">vampire</option>
        <option value="http://st.pimg.net/tucs/css/sh_vim-dark.min.css">vim-dark</option>
        <option value="http://st.pimg.net/tucs/css/sh_vim.min.css">vim</option>
        <option value="http://st.pimg.net/tucs/css/sh_whatis.min.css">whatis</option>
        <option value="http://st.pimg.net/tucs/css/sh_whitengrey.min.css">whitengrey</option>
        <option value="http://st.pimg.net/tucs/css/sh_zellner.min.css">zellner</option>
    </select>
</div>



<div class="footer"><div class="cpanstats">78163 Uploads, 24704 Distributions
105968 Modules, 9645 Uploaders
</div>
hosted by <a href="http://www.yellowbot.com">YellowBot</a><br/>
<a href="http://www.yellowbot.com"><img alt="do. tag. write. share." src="http://st.pimg.net/tucs/img/yellowbot_logo.gif"></a>
</div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript" src="http://ipv4.v6test.develooper.com/js/v1/v6test.js"></script>

<script type="text/javascript">
   // v6.target = '';
   if (!v6.target) { v6.only_once = true }
   v6.site = '7A0D89A6-2B82-11DF-B9DA-F61CBD13F020';
   v6.api_server = 'http://ipv4.v6test.develooper.com';
   try {
     v6.test();
   } catch(err) {}
</script>
<script type="text/javascript">
  $(document).ready(function(){
    $("a[href^=http:]").click(function(){
      var href = $(this).attr('href');
      var m = href.match('\/\/([^\/:]+)');
      _gaq.push(['_trackEvent','External',m[1],'Module']);
    });
    $("a[href^=/CPAN/]").click(function(){
      var href = $(this).attr('href');
      _gaq.push(['_trackEvent','Download',href,'Module']);
    });
  });
</script>
<!-- Tue Apr 24 21:47:25 2012 GMT (0.11034107208252) @cpansearch1 -->
 </body>
</html>
