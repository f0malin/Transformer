<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
 <head>
  <link rel="stylesheet" href="http://st.pimg.net/tucs/style.css" type="text/css" />
<style>
.styleswitch {
  text-align: right;
}
</style>


<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script type="text/javascript" src="http://st.pimg.net/tucs/js/jquery.cookie.js"></script>
<script type="text/javascript" src="http://st.pimg.net/tucs/js/sh_main.min.js"></script>
<script type="text/javascript" src="http://st.pimg.net/tucs/js/sh_perl.min.js"></script>
<script type="text/javascript" src="http://st.pimg.net/tucs/js/jquery.styleswitch.js"></script>

<link rel="stylesheet" href="http://st.pimg.net/tucs/print.css" type="text/css" media="print" />
  <link rel="alternate" type="application/rss+xml" title="RSS 1.0" href="http://search.cpan.org/uploads.rdf" />
  <link rel="search" href="http://st.pimg.net/tucs/opensearch.xml" type="application/opensearchdescription+xml" title="SearchCPAN" />
  <title>Test::LectroTest::Generator - search.cpan.org</title>
 <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-3528438-1']);
    _gaq.push(["_setCustomVar",2,"Distribution","Test-LectroTest",3]);
    _gaq.push(["_setCustomVar",5,"Release","Test-LectroTest-0.3600",3]);
    _gaq.push(["_setCustomVar",3,"Module","Test::LectroTest::Generator",3]);
    _gaq.push(["_setCustomVar",1,"Author","TMOERTEL",3]);
    _gaq.push(['_trackPageview']);
  </script>
 </head>
 <body id="cpansearch">
<center><div class="logo"><a href="/"><img src="http://st.pimg.net/tucs/img/cpan_banner.png" alt="CPAN"></a></div></center>
<div class="menubar">
 <a href="/">Home</a>
&middot; <a href="/author/">Authors</a>
&middot; <a href="/recent">Recent</a>
&middot; <a href="http://log.perl.org/cpansearch/">News</a>
&middot; <a href="/mirror">Mirrors</a>
&middot; <a href="/faq.html">FAQ</a>
&middot; <a href="/feedback">Feedback</a>
</div>
<form method="get" action="/search" name="f" class="searchbox">
<input type="text" name="query" value="" size="35">
<br>in <select name="mode">
 <option value="all">All</option>
 <option value="module" >Modules</option>
 <option value="dist" >Distributions</option>
 <option value="author" >Authors</option>
</select>&nbsp;<input type="submit" value="CPAN Search">
</form>


 <a name="_top"></a>
  <div class=path>
<div id=permalink class="noprint"><a href="/perldoc?Test::LectroTest::Generator">permalink</a></div>
  <a href="/~tmoertel/">Tom Moertel</a> &gt;
  <a href="/~tmoertel/Test-LectroTest-0.3600/">Test-LectroTest-0.3600</a> &gt;
  Test::LectroTest::Generator
 </div>

<div class="noprint" style="float:right;align:left;width:19ex">
<a href="http://hexten.net/cpan-faces/"><img src="http://www.gravatar.com/avatar/35a0e86eab9069913e72efac020c77b1?r=g&s=80&d=http%3A%2F%2Fst.pimg.net%2Ftucs%2Fimg%2Fwho.png" width=80 height=80 
style="float:right"
/></a>
<br style="clear:both"/>
<p style="text-align:right">Download:<br/> <a href="/CPAN/authors/id/T/TM/TMOERTEL/Test-LectroTest-0.3600.tar.gz">Test-LectroTest-0.3600.tar.gz</a></p>
<p style="text-align:right"><a href="http://deps.cpantesters.org/?module=Test%3A%3ALectroTest%3A%3AGenerator;perl=latest">Dependencies</a></p>
<p style="text-align:right"><a href="http://www.annocpan.org/~TMOERTEL/Test-LectroTest-0.3600/lib/Test/LectroTest/Generator.pm">Annotate this POD
</a></p>

<div style="float:right">
<div class=box style='width:150px'>
<h1 class=t5>CPAN RT</h1>
<div style="margin:2px">
<table style="margin-left:auto;margin-right:auto">
<tr><td>Open&nbsp;</td><td style="text-align:right"> 1</td></tr>
</table>
<a href="https://rt.cpan.org/Public/Dist/Display.html?Name=Test-LectroTest">View/Report Bugs</a><br/>
</div>
</div>

</div>
</div>
  Module Version:  0.14 &nbsp;
<span class="noprint">
  <a href="/src/TMOERTEL/Test-LectroTest-0.3600/lib/Test/LectroTest/Generator.pm">Source</a> &nbsp;
</span>
<a name="___top"></a>
<div class=pod>
<div class=toc>
<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#Sizing_guidance'>Sizing guidance</a>
    <li class='indexItem indexItem2'><a href='#Generators'>Generators</a>
    <li class='indexItem indexItem2'><a href='#Generator_combinators'>Generator combinators</a>
    <li class='indexItem indexItem2'><a href='#Rolling_your_own_generators'>Rolling your own generators</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#EXAMPLES'>EXAMPLES</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#Simple_examples'>Simple examples</a>
    <li class='indexItem indexItem2'><a href='#Advanced_examples'>Advanced examples</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#SEE_ALSO'>SEE ALSO</a>
  <li class='indexItem indexItem1'><a href='#LECTROTEST_HOME'>LECTROTEST HOME</a>
  <li class='indexItem indexItem1'><a href='#AUTHOR'>AUTHOR</a>
  <li class='indexItem indexItem1'><a href='#INSPIRATION'>INSPIRATION</a>
  <li class='indexItem indexItem1'><a href='#COPYRIGHT_and_LICENSE'>COPYRIGHT and LICENSE</a>
</ul>
</div>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME <img alt='^' src='http://st.pimg.net/tucs/img/up.gif'></a></h1>

<p>Test::LectroTest::Generator - Random value generators and combinators</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS <img alt='^' src='http://st.pimg.net/tucs/img/up.gif'></a></h1>

<pre class="sh_perl"> use Test::LectroTest::Generator qw(:common :combinators);

 my $int_gen = Int;
 my $pct_gen = Int( range=&#62;[0,100] );
 my $flt_gen = Float( range=&#62;[0,1] );
 my $bln_gen = Bool;
 my $chr_gen = Char( charset=&#62;&#34;a-z&#34; );
 my $str_gen = String( charset=&#62;&#34;A-Z0-9&#34;, length=&#62;[3,] );
 my $ary_gen = List( Int(sized=&#62;0) );
 my $hsh_gen = Hash( $str_gen, $pct_gen );
 my $uni_gen = Unit( &#34;e&#34; );  # always returns &#34;e&#34;
 my $elm_gen = Elements(&#34;e1&#34;, &#34;e2&#34;, &#34;e3&#34;, &#34;e4&#34;);

 for my $sizing_guidance (1..100) {
     my $i = $int_gen-&#62;generate( $sizing_guidance );
     print &#34;$i &#34;;
 }
 print &#34;\n&#34;;

 # generates single digits
 my $digit_gen  = Elements( 0..9 );  # or Int(range=&#62;[0,9],sized=&#62;0)

 # generates SSNs like &#34;910-77-2236&#34;
 my $ssn_gen    = Paste( Paste( ($digit_gen) x 3 ),
                         Paste( ($digit_gen) x 2 ),
                         Paste( ($digit_gen) x 4 ),
                         glue =&#62; &#34;-&#34;                );

 # print 10 SSNs
 print( map {$ssn_gen-&#62;generate($_).&#34;\n&#34;} 1..10 );

 my $english_dist_vowel_gen =
     Frequency( [8.167,Unit(&#34;a&#34;)], [12.702,Unit(&#34;e&#34;)],
                [6.996,Unit(&#34;i&#34;)], [ 7.507,Unit(&#34;o&#34;)],
                [2.758,Unit(&#34;u&#34;)] );
     # Source: <a href="http://www.csm.astate.edu/~rossa/datasec/frequency.html" class="podlinkurl"
>http://www.csm.astate.edu/~rossa/datasec/frequency.html</a></pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION <img alt='^' src='http://st.pimg.net/tucs/img/up.gif'></a></h1>

<p>This module provides random value generators for common data types and provides an interface and tools for creating your own generators. It also provides generator combinators that can be used to create more-complex generators by combining simple ones.</p>

<p>A generator is an object having a method <code>generate</code>, which takes a single argument, <i>size</i> and returns a new random value. The generated value is always a scalar. Generators that produce data structures return references to them.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Sizing_guidance"
>Sizing guidance</a></h2>

<p>The <code>generate</code> method interprets its <i>size</i> argument as guidance about the complexity of the value it should create. Typically, smaller <i>size</i> values result in smaller generated numbers and shorter generated strings and lists. Some generators, for which sizing doesn&#39;t make sense, ignore sizing guidance altogether; those that do use sizing guidance can be told to ignore it via the <b>sized</b> modifier.</p>

<p>The purpose of sizing is to allow LectroTest to generate simple values at first and then, as testing progresses, to slowly ramp up the complexity. In this way, counterexamples for obvious problems will be easier for you to understand.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Generators"
>Generators</a></h2>

<p>The following functions create fully-formed generators, ready to use. These functions are exported into your code&#39;s namespace if you ask for <code>:generators</code> or <code>:all</code> when you <code>use</code> this module.</p>

<p>Each generator has a <code>generate</code> method that you can call to extract a new, random value from the generator.</p>

<dl>
<dt><a name="Int"
>Int</a></dt>

<dd>
<pre class="sh_perl">    my $gen = Int( range=&#62;[0,9], sized=&#62;0 );</pre>

<p>Creates a generator for integer values, by default in the range [-32768,32767], inclusive, but this can be changed via the optional <b>range</b> modifier.</p>

<dl>
<dt><a name='Int'></a><a name="Int(_range=&#62;[low,_high]_)"
>Int( range=&#62;[<i>low</i>, <i>high</i>] )</a></dt>

<dd>
<p>Causes the generated values to be constrained to the range [<i>low</i>, <i>high</i>], inclusive. By default, the range is [-32768, 32767].</p>

<p><b>Note:</b> If your range is empty (i.e., <i>low</i> &#62; <i>high</i>), LectroTest will complain.</p>

<p><b>Note:</b> If zero is not within the range you provide, sizing makes no sense because the intersection of your range and the sizing range can be empty, and thus you must turn off sizing with <code>sized=&#62;0</code>. If you forget, LectroTest will complain.</p>

<dt><a name='Int'></a><a name="Int(_sized=&#62;bool_)"
>Int( sized=&#62;<i>bool</i> )</a></dt>

<dd>
<p>If true (the default), constrains the absolute value of the generated integers to the sizing guidance provided to the <code>generate</code> method. Otherwise, the generated values are constrained only by the range.</p>
</dd>
</dl>

<dt><a name="Float"
>Float</a></dt>

<dd>
<pre class="sh_perl">    my $gen = Float( range=&#62;[-2.0,2.0], sized=&#62;1 );</pre>

<p>Creates a generator for floating-point values, by default in the range [-32768.0,32768.0), but this can be changed via the optional <b>range</b> modifier. By default Float generators are sized.</p>

<dl>
<dt><a name='Float'></a><a name="Float(_range=&#62;[low,_high]_)"
>Float( range=&#62;[<i>low</i>, <i>high</i>] )</a></dt>

<dd>
<p>Causes the generated values to be constrained to the range [<i>low</i>, <i>high</i>). By default, the range is [-32768.0,32768.0). (Note that the <i>high</i> value itself can never be generated, but values infinitesimally close to it can.)</p>

<p><b>Note:</b> If your range is empty (i.e., <i>low</i> &#62; <i>high</i>), LectroTest will complain.</p>

<p><b>Note:</b> If zero is not within the range you provide, sizing makes no sense because the intersection of your range and the sizing range can be empty, and thus you must turn off sizing with <code>sized=&#62;0</code>. If you forget, LectroTest will complain.</p>

<dt><a name='Float'></a><a name="Float(_sized=&#62;bool_)"
>Float( sized=&#62;<i>bool</i> )</a></dt>

<dd>
<p>If true (the default), constrains the absolute value of the generated values to the sizing guidance provided to the <code>generate</code> method. Otherwise, the generated values are constrained only by the range.</p>
</dd>
</dl>

<dt><a name="Bool"
>Bool</a></dt>

<dd>
<pre class="sh_perl">    my $gen = Bool;</pre>

<p>Creates a generator for boolean values: 0 for false, 1 for true. The generator ignores sizing guidance.</p>

<dt><a name="Char"
>Char</a></dt>

<dd>
<pre class="sh_perl">    my $gen = Char( charset=&#62;&#34;A-Za-z0-9_&#34; );</pre>

<p>Creates a generator for characters. By default the characters are in the ASCII range [0,127], inclusive, but this behavior can be changed with the <b>charset</b> modifier:</p>

<dl>
<dt><a name='Char'></a><a name="Char(_charset=&#62;cset_)"
>Char( charset=&#62;<i>cset</i> )</a></dt>

<dd>
<p>Characters will be drawn from the character set given by the character-set specification <i>cset</i>. The syntax of <i>cset</i> is similar the Perl <code>tr</code> built-in and is a string comprised of characters and character ranges:</p>

<dl>
<dt><a name="c"
><i>c</i></a></dt>

<dd>
<p>Adds the character <i>c</i> to the set.</p>

<dt><a name='c'></a><a name="c-d"
><i>c</i>-<i>d</i></a></dt>

<dd>
<p>Adds the characters in the range <i>c</i> through <i>d</i> (inclusive) to the set. Note: If <i>c</i> is lexicographically greater than <i>d</i>, the range is empty, and no characters will be added to the set.</p>
</dd>
</dl>

<p>Examples:</p>

<dl>
<dt><a name='charset'></a><a name="charset=&#62;&#34;abcdwxyz&#34;"
>charset=&#62;&#34;abcdwxyz&#34;</a></dt>

<dd>
<p>The characters &#34;a&#34;, &#34;b&#34;, &#34;c&#34;, &#34;d&#34;, &#34;w&#34;, &#34;x&#34;, &#34;y&#34;, and &#34;z&#34; are in the set.</p>

<dt><a name='charset'></a><a name="charset=&#62;&#34;a-dx-z&#34;"
>charset=&#62;&#34;a-dx-z&#34;</a></dt>

<dd>
<p>Shorter version of the previous example.</p>

<dt><a name='charset'></a><a name="charset=&#62;&#34;\x00-\x7f&#34;"
>charset=&#62;&#34;\x00-\x7f&#34;</a></dt>

<dd>
<p>The ASCII character set.</p>

<dt><a name='charset'></a><a name="charset=&#62;&#34;-_A-Za-z0-9&#34;"
>charset=&#62;&#34;-_A-Za-z0-9&#34;</a></dt>

<dd>
<p>The character set contains &#34;-&#34;, &#34;_&#34;, upper- and lower-case ASCII letters, and the digits 0-9. Notice that the dash must occur first so that it is not misinterpreted as denoting a range of characters.</p>
</dd>
</dl>
</dd>
</dl>

<dt><a name='List'></a><a name="List(elemgen)"
>List(<i>elemgen</i>)</a></dt>

<dd>
<pre class="sh_perl">    my $gen = List( Bool, length=&#62;[1,10] );</pre>

<p>Creates a generator for lists (which are returned as array refs). The elements of the lists are generated by the generator given as <i>elemgen</i>. The lengths of the generated lists are constrained by sizing guidance at the time of generation. You can override the default sizing behavior using the optional <b>length</b> modifier:</p>

<p>When the list generator calls the element generator, it divides the sizing guidance by the length of the list. For example, if the list being generated will have 7 elements, when the list generator calls the element generator to generate each element, it will scale the sizing guidance by 1/7. In this way the sizing guidance provides a rough constraint on the total number of elements produced, regardless of the depth of the list structure being generated.</p>

<dl>
<dt><a name='List'></a><a name="List(_...,_length=&#62;N_)"
>List( ..., length=&#62;<i>N</i> )</a></dt>

<dd>
<p>Generated lists are exactly length <i>N</i>.</p>

<dt><a name='List'></a><a name="List(_...,_length=&#62;[M,]_)"
>List( ..., length=&#62;[<i>M</i>,] )</a></dt>

<dd>
<p>Generated lists are at least length <i>M</i>. (Maximum length is constrained by sizing factor.)</p>

<dt><a name='List'></a><a name="List(_...,_length=&#62;[M,N]_)"
>List( ..., length=&#62;[<i>M</i>,<i>N</i>] )</a></dt>

<dd>
<p>Generated lists are of length between <i>M</i> and <i>N</i>, inclusive. Sizing guidance is ignored.</p>
</dd>
</dl>

<p><b>Advanced Note:</b> If more than one <i>elemgen</i> is given, they will be used in turn to create successive elements. In this case, the length of the list will be multiplied by the number of generators given. For example, providing two generators will create double-length lists.</p>

<dt><a name='Hash'></a><a name="Hash(keygen,_valgen)"
>Hash(<i>keygen</i>, <i>valgen</i>)</a></dt>

<dd>
<pre class="sh_perl">    my $gen = Hash( String( charset=&#62;&#34;A-Z&#34;, length=&#62;3 ),
                    Float( range=&#62;[0.0, 100.0] );</pre>

<p>Creates a generator for hashes (which are returned as hash refs). The keys of the hash are generated by the generator given as <i>keygen</i>, and the values are generated by the generator <i>valgen</i>.</p>

<p>The Hash generator takes an optional <b>length</b> modifier that specifies the desired hash length (= number of keys):</p>

<dl>
<dt><a name='Hash'></a><a name="Hash(_...,_length=&#62;length-spec_)"
>Hash( ..., length=&#62;<i>length-spec</i> )</a></dt>

<dd>
<p>Specifies the desired length of the generated hashes, using the same <i>length-spec</i> syntax as for the List generator. Note that the generated hashes may be smaller than expected because of key collision.</p>
</dd>
</dl>

<dt><a name="String"
>String</a></dt>

<dd>
<pre class="sh_perl">    my $gen = String( length=&#62;[3,], charset=&#62;&#34;A-Z&#34; );</pre>

<p>Creates a generator for strings. By default the strings will be drawn from the ASCII character set (0 through 127) and be of length constrained by the sizing factor. Both defaults can be changed using modifiers:</p>

<dl>
<dt><a name='String'></a><a name="String(_charset=&#62;cset_)"
>String( charset=&#62;<i>cset</i> )</a></dt>

<dd>
<p>Characters will be drawn from the character set given by the character-set specification <i>cset</i>. The syntax of <i>cset</i> is similar the Perl <code>tr</code> operator and is a string comprised of characters and character ranges. See Char for a full description.</p>

<dt><a name='String'></a><a name="String(_length=&#62;length-spec_)"
>String( length=&#62;<i>length-spec</i> )</a></dt>

<dd>
<p>Specifies the desired length of generated strings, using the same <i>length-spec</i> syntax as for the List generator.</p>
</dd>
</dl>

<dt><a name='Elements'></a><a name="Elements(e1,_e2,_...)"
>Elements(<i>e1</i>, <i>e2</i>, ...)</a></dt>

<dd>
<pre class="sh_perl">    my $gen = Elements( &#34;alpha&#34;, &#34;beta&#34;, &#34;gamma&#34; );</pre>

<p>Creates a generator that chooses among the given elements <i>e1</i>, <i>e2</i>, ... with equal probability. Each call to the <code>generate</code> method will return one of the element values. Sizing guidance has no effect on this generator.</p>

<p><b>Note:</b> This generator builder does not accept modifiers. If you pass any, they will be interpreted as elements to be added to the pool from which the generator randomly selects, which is probably not what you want.</p>

<dt><a name='Unit'></a><a name="Unit(e)"
>Unit(<i>e</i>)</a></dt>

<dd>
<pre class="sh_perl">    my $gen = Unit( &#34;alpha&#34; );</pre>

<p>Creates a generator that always returns the value <i>e</i>. Not too useful on its own but can be handy as a building block for combinators to chew on. Naturally, sizing guidance has no effect on this generator.</p>

<p><b>Note:</b> This generator builder does not accept modifiers.</p>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Generator_combinators"
>Generator combinators</a></h2>

<p>The following combinators allow you to build more complicated generators from simpler ones. These combinators are exported into your code&#39;s namespace if you ask for <code>:combinators</code> or <code>:all</code> when you <code>use</code> this module.</p>

<dl>
<dt><a name='Paste'></a><a name="Paste(gens...,_glue=&#62;str)"
>Paste(<i>gens</i>..., glue=&#62;<i>str</i>)</a></dt>

<dd>
<pre class="sh_perl">    my $gen = Paste( (String(charset=&#62;&#34;0-9&#34;,length=&#62;4)) x 4,
                     glue =&#62; &#34; &#34; );
    # gens credit-card numbers like &#34;4592 9459 9023 1369&#34;

    my $lgen = Paste( List( String(charset=&#62;&#34;0-9&#34;,length=&#62;4)
                          , length=&#62;4 ), glue =&#62; &#34; &#34; );
    # another way of doing the same</pre>

<p>Creates a combined generator that generates values by joining the values generated by each of the supplied sub-generators <i>gens</i>. (Generated list values will have their elements &#34;flattened&#34; into the rest of the generated results before joining.) The resulting string is returned.</p>

<p>The values are joined using the given glue string <i>str</i>. If no <b>glue</b> modifier is provided, the default glue is the empty string.</p>

<p>The sizing guidance given to the combined generator will be passed unchanged to each of the sub-generators.</p>

<dt><a name='OneOf'></a><a name="OneOf(gens...)"
>OneOf(<i>gens</i>...)</a></dt>

<dd>
<pre class="sh_perl">    my $gen = OneOf( Unit(0), List(Int,length=&#62;3) );
    # generates scalar 0 or a 3-element list of integers</pre>

<p>Creates a combined generator that generates each value by selecting at random (with equal probability) one of the sub-generators in <i>gens</i> and using that generator to generate the output value.</p>

<p>The sizing guidance given to the combined generator will be passed unchanged to the selected sub-generator.</p>

<p><b>Note:</b> This combinator does not accept modifiers.</p>

<dt><a name='Frequency'></a><a name="Frequency([freq1,_gen1],_[freq2,_gen2],_...)"
>Frequency([<i>freq1</i>, <i>gen1</i>], [<i>freq2</i>, <i>gen2</i>], ...)</a></dt>

<dd>
<pre class="sh_perl">    my $gen = Frequency( [50, Unit(&#34;common&#34;     )],
                         [35, Unit(&#34;less common&#34;)],
                         [15, Unit(&#34;uncommon&#34;   )] );
    # generates one of &#34;common&#34;, &#34;less common&#34;, or
    # &#34;uncommon&#34; with respective probabilities
    # 50%, 35%, and 15%.</pre>

<p>Creates a combined generator that generates each value by selecting at random one of the generators <i>gen1</i> or <i>gen2</i> or ... and using that generator to generate the output value. Each generator is selected with probability proportional to its associated frequency. (If all of the given frequencies are the same, the Frequency combinator effectively becomes OneOf.) The frequencies can be any non-negative numerical values you want and will be normalized to a 0-to-1 scale internally. At least one frequency must be greater than zero.</p>

<p>The sizing guidance given to the combined generator will be passed unchanged to the selected sub-generator.</p>

<p><b>Note:</b> This combinator does not accept modifiers.</p>

<dt><a name='Each'></a><a name="Each(gens...)"
>Each(<i>gens</i>...)</a></dt>

<dd>
<pre class="sh_perl">    my $gen = Each( Unit(1), Unit(&#34;X&#34;) );
    # always generates [ 1, &#34;X&#34; ]</pre>

<p>Creates a generator that returns a list (array ref) whose successive elements are the successive values generated by the given generators <i>gens</i>.</p>

<p>The sizing guidance given to the combined generator will be passed unchanged to each sub-generator.</p>

<p><b>Note:</b> This combinator does not accept modifiers.</p>

<p>(Note for technical buffs: <code>Each(...)</code> is exactly equivalent to <code>List(..., length=&#62;1)</code>).</p>

<dt><a name='Apply'></a><a name="Apply(fn,_gens...)"
>Apply(<i>fn</i>, <i>gens</i>...)</a></dt>

<dd>
<pre class="sh_perl">    my $gen = Apply( sub { $_[0] x $_[1] }
                   , Unit(&#34;X&#34;), Unit(4) );
    # always generates &#34;XXXX&#34;</pre>

<p>Creates a generator that applies the given function <i>fn</i> to arguments generated from each of the given sub-generators <i>gens</i> and returns the resulting value. Each sub-generator contributes one value, and the values are passed to <i>fn</i> as arguments in the same order as the sub-generators were given to Apply.</p>

<p>The sizing guidance given to the combined generator will be passed unchanged to each sub-generator.</p>

<p><b>Note:</b> The function <i>fn</i> is always evaluated in scalar context. If you need to generate an array, return it as an array reference.</p>

<p><b>Note:</b> This combinator does not accept modifiers.</p>

<dt><a name='Map'></a><a name="Map(fn,_gens...)"
>Map(<i>fn</i>, <i>gens</i>...)</a></dt>

<dd>
<pre class="sh_perl">    my $gen = Map( sub { &#34;X&#34; x $_[0] }
                 , Unit(4), Unit(3), Unit(0) );
    # always generates [ &#34;XXXX&#34;, &#34;XXX&#34;, &#34;&#34; ]</pre>

<p>Creates a generator that applies the given function <i>fn</i> to the values generated by the given generators <i>gen</i> one at a time and returns a list (array ref) whose elements are each of the successive results.</p>

<p>The sizing guidance given to the combined generator will be passed unchanged to each sub-generator.</p>

<p><b>Note:</b> The function <i>fn</i> is always evaluated in scalar context. If you need to generate an array, return it as an array reference.</p>

<p><b>Note:</b> This combinator does not accept modifiers.</p>

<dt><a name='Concat'></a><a name="Concat(gens...)"
>Concat(<i>gens</i>...)</a></dt>

<dd>
<pre class="sh_perl">    my $gen = Concat( List( Unit(1),   length=&#62;3 )
                    , List( Unit(&#34;x&#34;), length=&#62;1 ) );
    # always generates [1, 1, 1, &#34;x&#34;]</pre>

<p>Creates a generator that concatenates the values generated by each of its sub-generators, resulting in a list (which is returned as a array reference). The values returned by the sub-generators are expected to be lists (array refs). If a sub-generator returns a scalar value, it will be treated like a single-element list that contains the value.</p>

<p>The sizing guidance given to the combined generator will be passed unchanged to each sub-generator.</p>

<p><b>Note:</b> If a sub-generator returns something other than a list or scalar, you will get a run-time error.</p>

<p><b>Note:</b> This combinator does not accept modifiers.</p>

<dt><a name='Flatten'></a><a name="Flatten(gens...)"
>Flatten(<i>gens</i>...)</a></dt>

<dd>
<pre class="sh_perl">    my $gen = Flatten( Unit( [[[[[[ 1 ]]]]]] ) );
    # generates [1]</pre>

<p>Flatten is just like Concat except that it recursively flattens any sublists generated by the generators <i>gen</i> and then concatenates them to generate a final a list of depth one, regardless of the depth of any sublists.</p>

<p>The sizing guidance given to the combined generator will be passed unchanged to each sub-generator.</p>

<p><b>Note:</b> If a sub-generator returns something other than a list or scalar, you will get a run-time error.</p>

<p><b>Note:</b> This combinator does not accept modifiers.</p>

<dt><a name='ConcatMap'></a><a name="ConcatMap(fn,_gens)"
>ConcatMap(<i>fn</i>, <i>gens</i>)</a></dt>

<dd>
<pre class="sh_perl">    sub take_odds { my $x = shift;
                    $x % 2 ? [$x] : [] }
    my $gen = ConcatMap( \&#38;take_odds
                       , Unit(1), Unit(2), Unit(3) );
    # generates [1, 3]</pre>

<p>Creates a generator that applies the function <i>fn</i> to each of the values generated by the given generators <i>gen</i> in turn, and then concatenates the results.</p>

<p>The sizing guidance given to the combined generator will be passed unchanged to each sub-generator.</p>

<p><b>Note:</b> The function <i>fn</i> is always evaluated in scalar context. If you need to generate an array, return it as an array reference.</p>

<p><b>Note:</b> If a sub-generator returns something other than a list or scalar, you will get a run-time error.</p>

<p><b>Note:</b> This combinator does not accept modifiers.</p>

<dt><a name='FlattenMap'></a><a name="FlattenMap(fn,_gens)"
>FlattenMap(<i>fn</i>, <i>gens</i>)</a></dt>

<dd>
<pre class="sh_perl">    my $gen = FlattenMap( sub { [ ($_[0]) x 3 ] }
                        , Unit([1]), Unit([[2]]) );
    # generates [1, 1, 1, 2, 2, 2]</pre>

<p>Creates a generator that applies the function <i>fn</i> to each of the values generated by the given generators <i>gen</i> in turn, and then flattens and concatenates the results.</p>

<p>The sizing guidance given to the combined generator will be passed unchanged to each sub-generator.</p>

<p><b>Note:</b> The function <i>fn</i> is always evaluated in scalar context. If you need to generate an array, return it as an array reference.</p>

<p><b>Note:</b> If a sub-generator returns something other than a list or scalar, you will get a run-time error.</p>

<p><b>Note:</b> This combinator does not accept modifiers.</p>

<dt><a name='Sized'></a><a name="Sized(fn,_gen)"
>Sized(<i>fn</i>, <i>gen</i>)</a></dt>

<dd>
<pre class="sh_perl">    my $gen = Sized { 2 * $_[0] } List(Int);
        # ^ magnify sizing guidance by factor of two
    my $gen2 = Sized { 10 } Int;
        # ^ use constant guidance of 10</pre>

<p>Creates a generator that adjusts sizing guidance by passing it through the function <i>fn</i>. Then it calls the generator <i>gen</i> with the adjusted guidance and returns the result.</p>

<p><b>Note:</b> This combinator does not accept modifiers.</p>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Rolling_your_own_generators"
>Rolling your own generators</a></h2>

<p>You can create your own generators by creating any object that has a <code>generate</code> method. Your method should accept as its first argument sizing guidance <i>size</i> and, if it makes sense, adjust the complexity of the values it generates accordingly.</p>

<p>The easiest way to create a generator is by using the magic function <code>Gen</code>. It promotes a block of code into a generator. For example, here&#39;s a home-brew generator for times in ctime(3) format that is built on top of an Int generator:</p>

<pre class="sh_perl">  use Test::LectroTest::Generator qw( :common Gen );

  my $time_gen = Int(range=&#62;[0, 2_147_483_647], sized=&#62;0);
  my $ctime_gen = Gen {
      scalar localtime $time_gen-&#62;generate( @_ );
  };

  print($ctime_gen-&#62;generate($_), &#34;\n&#34;) for 1..5;
  # Fri Jun  2 18:13:21 1978
  # Thu Mar 28 00:55:51 1974
  # Wed Mar 26 06:41:09 2025
  # Sun Sep 11 15:39:44 2016
  # Fri Dec 26 00:39:31 1975</pre>

<p>Alternatively, we could build the generator using the Apply combinator:</p>

<pre class="sh_perl">  my $ctime_gen2 = Apply { localtime $_[0] } $time_gen;</pre>

<p><b>Note:</b> <code>Gen</code> is not exported into your code&#39;s namespace by default. If you want to use it, you must import it by name or import <code>:all</code> when you use this module.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="EXAMPLES"
>EXAMPLES <img alt='^' src='http://st.pimg.net/tucs/img/up.gif'></a></h1>

<p>Here are some examples to consider.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Simple_examples"
>Simple examples</a></h2>

<pre class="sh_perl"> use strict;
 use Test::LectroTest::Generator qw(:common);

 show(&#34;Ints (sized by default)&#34;, Int);

 show(&#34;Floats (sized by default)&#34;, Float);

 show(&#34;Percentages (unsized)&#34;,
      Int( range=&#62;[0,100], sized=&#62;0 ));

 show(&#34;Lists (sized by default) of Ints (unsized) in [0,10]&#34;,
      List( Int( sized=&#62;0, range=&#62;[0,10] ) ));

 show(&#34;Uppercase-alpha identifiers at least 3 chars long&#34;,
      String( length=&#62;[3,], charset=&#62;&#34;A-Z&#34; ));


 show(&#34;Hashes (sized by default) of form AAA=&#62;Digit&#34;,
      Hash( String( length=&#62;3, charset=&#62;&#34;A-Z&#34; ),
            Int( sized=&#62;0, range=&#62;[0,9] ) ));

 sub show {
     print &#34;\n&#34;, shift(), &#34;\n&#34;;
     my ($gen) = @_;
     for (1..10) {
         my $val = $gen-&#62;generate($_);
         printf &#34;Size %2d:  &#34;, $_;
         if (ref $val eq &#34;HASH&#34;) {
             my @pairs = map {&#34;$_=&#62;$val-&#62;{$_}&#34;} keys %$val;
             print &#34;{ @pairs }&#34;;
         }
         elsif (ref $val eq &#34;ARRAY&#34;) {
             print &#34;[ @$val ]&#34;
         }
         else {
             print $val;
         }
         print &#34;\n&#34;;
     }
 }</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Advanced_examples"
>Advanced examples</a></h2>

<p>For these examples we use <code>Data::Dumper</code> to inspect the data structures we generate. Also, we import not only the common generator constructors (like Int) but also the generic Gen constructor, which lets us build generators out of blocks on the fly.</p>

<pre class="sh_perl">    use Data::Dumper;
    use Test::LectroTest::Generator qw(:common Gen);</pre>

<p>First, here&#39;s a recipe for building a list of lists of integers:</p>

<pre class="sh_perl">    my $loloi_gen = List( List( Int(sized=&#62;0) ) );
    print Dumper($loloi_gen-&#62;generate(10));</pre>

<p>You may want to run the example several times to get a feel for the distribution of the generated output.</p>

<p>Now, a more complicated example. Here we build sized trees of random depth using a recursive set of generators.</p>

<pre class="sh_perl">    my $tree_gen = do {
        my $density = 0.5;
        my $leaf_gen = Int( sized=&#62;0 );
        my $tree_helper = \1;
        my $branch_gen = List( Gen { $$tree_helper-&#62;generate(@_) } );
        $tree_helper = \Gen {
            my ($size) = @_;
            return rand($size) &#60; $density
                ? $leaf_gen-&#62;generate($size)
                : $branch_gen-&#62;generate($size + 1);
        };
        $$tree_helper;
    };

    print Dumper($tree_gen-&#62;generate(30));</pre>

<p>We define a tree as either a leaf or a branch, and we randomly decide between the two at each node in the growing tree. Leaves are just integers and become more likely when the sizing guidance diminishes (which happens as we go deeper). The code uses <code>$density</code> as a control knob for leaf density. (Try re-running the above code after changing the value of <code>$density</code>. Try 0, 1, and 2.) Branches, on the other hand, are lists of trees. Because branches generate trees, and trees generate branches, we use a reference trick to set up the mutually recursive relationship. This we encapsulate within a <b>do</b> block for tidiness.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SEE_ALSO"
>SEE ALSO <img alt='^' src='http://st.pimg.net/tucs/img/up.gif'></a></h1>

<p><a href="/~tmoertel/Test-LectroTest-0.3600/lib/Test/LectroTest.pm" class="podlinkpod"
>Test::LectroTest</a> gives a quick overview of automatic, specification-based testing with LectroTest.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="LECTROTEST_HOME"
>LECTROTEST HOME <img alt='^' src='http://st.pimg.net/tucs/img/up.gif'></a></h1>

<p>The LectroTest home is <a href="http://community.moertel.com/LectroTest" class="podlinkurl"
>http://community.moertel.com/LectroTest</a>. There you will find more documentation, presentations, mailing-list archives, a wiki, and other helpful LectroTest-related resources. It&#39;s also the best place to ask questions.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR"
>AUTHOR <img alt='^' src='http://st.pimg.net/tucs/img/up.gif'></a></h1>

<p>Tom Moertel (tom@moertel.com)</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="INSPIRATION"
>INSPIRATION <img alt='^' src='http://st.pimg.net/tucs/img/up.gif'></a></h1>

<p>The LectroTest project was inspired by Haskell&#39;s QuickCheck module by Koen Claessen and John Hughes: <a href="http://www.cs.chalmers.se/~rjmh/QuickCheck/" class="podlinkurl"
>http://www.cs.chalmers.se/~rjmh/QuickCheck/</a>.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="COPYRIGHT_and_LICENSE"
>COPYRIGHT and LICENSE <img alt='^' src='http://st.pimg.net/tucs/img/up.gif'></a></h1>

<p>Copyright (c) 2004-05 by Thomas G Moertel. All rights reserved.</p>

<p>This program is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p>

</div>
<!-- This should probably be put in the <div class="footer"></div> -->
<script type="text/javascript">
    $(document).ready(function(){
        var startingStyle = $.cookie('css') ? $.cookie('css') : 'http://st.pimg.net/tucs/css/sh_none.min.css';
        $.fn.styleSwitch(startingStyle);
        $("#styleswitch").val(startingStyle);
        sh_highlightDocument();
        $("#styleswitch").bind(($.browser.msie ? "click" : "change"), function() {
            $.fn.styleSwitch($(this).val());
        });
    });
</script>
<div class="styleswitch">
    syntax highlighting:
    <select id="styleswitch">
        <option value="http://st.pimg.net/tucs/css/sh_none.min.css">no syntax highlighting</option>
        <option value="http://st.pimg.net/tucs/css/sh_acid.min.css">acid</option>
        <option value="http://st.pimg.net/tucs/css/sh_berries-dark.min.css">berries-dark</option>
        <option value="http://st.pimg.net/tucs/css/sh_berries-light.min.css">berries-light</option>
        <option value="http://st.pimg.net/tucs/css/sh_bipolar.min.css">bipolar</option>
        <option value="http://st.pimg.net/tucs/css/sh_blacknblue.min.css">blacknblue</option>
        <option value="http://st.pimg.net/tucs/css/sh_bright.min.css">bright</option>
        <option value="http://st.pimg.net/tucs/css/sh_contrast.min.css">contrast</option>
        <option value="http://st.pimg.net/tucs/css/sh_cpan.min.css">cpan</option>
        <option value="http://st.pimg.net/tucs/css/sh_darkblue.min.css">darkblue</option>
        <option value="http://st.pimg.net/tucs/css/sh_darkness.min.css">darkness</option>
        <option value="http://st.pimg.net/tucs/css/sh_desert.min.css">desert</option>
        <option value="http://st.pimg.net/tucs/css/sh_dull.min.css">dull</option>
        <option value="http://st.pimg.net/tucs/css/sh_easter.min.css">easter</option>
        <option value="http://st.pimg.net/tucs/css/sh_emacs.min.css">emacs</option>
        <option value="http://st.pimg.net/tucs/css/sh_golden.min.css">golden</option>
        <option value="http://st.pimg.net/tucs/css/sh_greenlcd.min.css">greenlcd</option>
        <option value="http://st.pimg.net/tucs/css/sh_ide-anjuta.min.css">ide-anjuta</option>
        <option value="http://st.pimg.net/tucs/css/sh_ide-codewarrior.min.css">ide-codewarrior</option>
        <option value="http://st.pimg.net/tucs/css/sh_ide-devcpp.min.css">ide-devcpp</option>
        <option value="http://st.pimg.net/tucs/css/sh_ide-eclipse.min.css">ide-eclipse</option>
        <option value="http://st.pimg.net/tucs/css/sh_ide-kdev.min.css">ide-kdev</option>
        <option value="http://st.pimg.net/tucs/css/sh_ide-msvcpp.min.css">ide-msvcpp</option>
        <option value="http://st.pimg.net/tucs/css/sh_kwrite.min.css">kwrite</option>
        <option value="http://st.pimg.net/tucs/css/sh_matlab.min.css">matlab</option>
        <option value="http://st.pimg.net/tucs/css/sh_navy.min.css">navy</option>
        <option value="http://st.pimg.net/tucs/css/sh_nedit.min.css">nedit</option>
        <option value="http://st.pimg.net/tucs/css/sh_neon.min.css">neon</option>
        <option value="http://st.pimg.net/tucs/css/sh_night.min.css">night</option>
        <option value="http://st.pimg.net/tucs/css/sh_pablo.min.css">pablo</option>
        <option value="http://st.pimg.net/tucs/css/sh_peachpuff.min.css">peachpuff</option>
        <option value="http://st.pimg.net/tucs/css/sh_print.min.css">print</option>
        <option value="http://st.pimg.net/tucs/css/sh_rand01.min.css">rand01</option>
	<option value="http://st.pimg.net/tucs/css/sh_solarized-dark.min.css">solarized-dark</option>
	<option value="http://st.pimg.net/tucs/css/sh_solarized-light.min.css">solarized-light</option>
        <option value="http://st.pimg.net/tucs/css/sh_style.min.css">style</option>
        <option value="http://st.pimg.net/tucs/css/sh_the.min.css">the</option>
        <option value="http://st.pimg.net/tucs/css/sh_typical.min.css">typical</option>
        <option value="http://st.pimg.net/tucs/css/sh_vampire.min.css">vampire</option>
        <option value="http://st.pimg.net/tucs/css/sh_vim-dark.min.css">vim-dark</option>
        <option value="http://st.pimg.net/tucs/css/sh_vim.min.css">vim</option>
        <option value="http://st.pimg.net/tucs/css/sh_whatis.min.css">whatis</option>
        <option value="http://st.pimg.net/tucs/css/sh_whitengrey.min.css">whitengrey</option>
        <option value="http://st.pimg.net/tucs/css/sh_zellner.min.css">zellner</option>
    </select>
</div>



<div class="footer"><div class="cpanstats">78179 Uploads, 24710 Distributions
106004 Modules, 9645 Uploaders
</div>
hosted by <a href="http://www.yellowbot.com">YellowBot</a><br/>
<a href="http://www.yellowbot.com"><img alt="do. tag. write. share." src="http://st.pimg.net/tucs/img/yellowbot_logo.gif"></a>
</div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript" src="http://ipv4.v6test.develooper.com/js/v1/v6test.js"></script>

<script type="text/javascript">
   // v6.target = '';
   if (!v6.target) { v6.only_once = true }
   v6.site = '7A0D89A6-2B82-11DF-B9DA-F61CBD13F020';
   v6.api_server = 'http://ipv4.v6test.develooper.com';
   try {
     v6.test();
   } catch(err) {}
</script>
<script type="text/javascript">
  $(document).ready(function(){
    $("a[href^=http:]").click(function(){
      var href = $(this).attr('href');
      var m = href.match('\/\/([^\/:]+)');
      _gaq.push(['_trackEvent','External',m[1],'Module']);
    });
    $("a[href^=/CPAN/]").click(function(){
      var href = $(this).attr('href');
      _gaq.push(['_trackEvent','Download',href,'Module']);
    });
  });
</script>
<!-- Wed Apr 25 06:30:44 2012 GMT (0.127785921096802) @cpansearch1 -->
 </body>
</html>
