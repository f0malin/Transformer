<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
 <head>
  <link rel="stylesheet" href="http://st.pimg.net/tucs/style.css" type="text/css" />
<style>
.styleswitch {
  text-align: right;
}
</style>


<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script type="text/javascript" src="http://st.pimg.net/tucs/js/jquery.cookie.js"></script>
<script type="text/javascript" src="http://st.pimg.net/tucs/js/sh_main.min.js"></script>
<script type="text/javascript" src="http://st.pimg.net/tucs/js/sh_perl.min.js"></script>
<script type="text/javascript" src="http://st.pimg.net/tucs/js/jquery.styleswitch.js"></script>

<link rel="stylesheet" href="http://st.pimg.net/tucs/print.css" type="text/css" media="print" />
  <link rel="alternate" type="application/rss+xml" title="RSS 1.0" href="http://search.cpan.org/uploads.rdf" />
  <link rel="search" href="http://st.pimg.net/tucs/opensearch.xml" type="application/opensearchdescription+xml" title="SearchCPAN" />
  <title>Crypt::DH - search.cpan.org</title>
 <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-3528438-1']);
    _gaq.push(["_setCustomVar",2,"Distribution","Crypt-DH",3]);
    _gaq.push(["_setCustomVar",5,"Release","Crypt-DH-0.06",3]);
    _gaq.push(["_setCustomVar",3,"Module","Crypt::DH",3]);
    _gaq.push(["_setCustomVar",1,"Author","BTROTT",3]);
    _gaq.push(['_trackPageview']);
  </script>
 </head>
 <body id="cpansearch">
<center><div class="logo"><a href="/"><img src="http://st.pimg.net/tucs/img/cpan_banner.png" alt="CPAN"></a></div></center>
<div class="menubar">
 <a href="/">Home</a>
&middot; <a href="/author/">Authors</a>
&middot; <a href="/recent">Recent</a>
&middot; <a href="http://log.perl.org/cpansearch/">News</a>
&middot; <a href="/mirror">Mirrors</a>
&middot; <a href="/faq.html">FAQ</a>
&middot; <a href="/feedback">Feedback</a>
</div>
<form method="get" action="/search" name="f" class="searchbox">
<input type="text" name="query" value="" size="35">
<br>in <select name="mode">
 <option value="all">All</option>
 <option value="module" >Modules</option>
 <option value="dist" >Distributions</option>
 <option value="author" >Authors</option>
</select>&nbsp;<input type="submit" value="CPAN Search">
</form>


 <a name="_top"></a>
  <div class=path>
<div id=permalink class="noprint"><a href="/perldoc?Crypt::DH">permalink</a></div>
  <a href="/~btrott/">Benjamin Trott</a> &gt;
  <a href="/~btrott/Crypt-DH-0.06/">Crypt-DH-0.06</a> &gt;
  Crypt::DH
 </div>

<div class="noprint" style="float:right;align:left;width:19ex">
<a href="http://hexten.net/cpan-faces/"><img src="http://www.gravatar.com/avatar/6be1a4eb5479cef0cdf07984c2c3b8ea?r=g&s=80&d=http%3A%2F%2Fst.pimg.net%2Ftucs%2Fimg%2Fwho.png" width=80 height=80 
style="float:right"
/></a>
<br style="clear:both"/>
<p style="text-align:right">Download:<br/> <a href="/CPAN/authors/id/B/BT/BTROTT/Crypt-DH-0.06.tar.gz">Crypt-DH-0.06.tar.gz</a></p>
<p style="text-align:right"><a href="http://deps.cpantesters.org/?module=Crypt%3A%3ADH;perl=latest">Dependencies</a></p>
<p style="text-align:right"><a href="http://www.annocpan.org/~BTROTT/Crypt-DH-0.06/lib/Crypt/DH.pm">Annotate this POD
</a></p>
<div class=box style='width:150px; float: right'>
<h1 class=t5>Related Modules</h1>
<div style="margin:2px">
<a href="/perldoc?Net%3A%3ASSH%3A%3APerl">Net::SSH::Perl</a><br>
<a href="/perldoc?Net%3A%3ASFTP">Net::SFTP</a><br>
<a href="/perldoc?Math%3A%3ABigInt">Math::BigInt</a><br>
<a href="/perldoc?Math%3A%3APari">Math::Pari</a><br>
<a href="/perldoc?Digest%3A%3ASHA1">Digest::SHA1</a><br>
<a href="/perldoc?Net%3A%3ASSH">Net::SSH</a><br>
<a href="/perldoc?CGI%3A%3ASession">CGI::Session</a><br>
<a href="/perldoc?Crypt%3A%3ADSA">Crypt::DSA</a><br>
<a href="/perldoc?Math%3A%3ABigInt%3A%3AGMP">Math::BigInt::GMP</a><br>
<a href="/perldoc?Crypt%3A%3ARijndael">Crypt::Rijndael</a><br>
<small>
<a href="http://perlmonks.org/?node=cpan+module+search&pivot=1&module=Crypt%3A%3ADH">more...</a><br>
By <a href="http://perlmonks.org/">perlmonks.org</a></small>
</div>
</div>

<div style="float:right">
<div class=box style='width:150px'>
<h1 class=t5>CPAN RT</h1>
<div style="margin:2px">
<table style="margin-left:auto;margin-right:auto">
<tr><td>New&nbsp;</td><td style="text-align:right"> 4</td></tr>
<tr><td>Open&nbsp;</td><td style="text-align:right"> 5</td></tr>
</table>
<a href="https://rt.cpan.org/Public/Dist/Display.html?Name=Crypt-DH">View/Report Bugs</a><br/>
</div>
</div>

</div>
</div>
  Module Version:  0.06 &nbsp;
<span class="noprint">
  <a href="/src/BTROTT/Crypt-DH-0.06/lib/Crypt/DH.pm">Source</a> &nbsp;
</span>
<a name="___top"></a>
<div class=pod>
<div class=toc>
<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#THE_ALGORITHM'>THE ALGORITHM</a>
  <li class='indexItem indexItem1'><a href='#USAGE'>USAGE</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#$dh_=_Crypt::DH-&#62;new([_%param_]).'>$dh = Crypt::DH-&#62;new([ %param ]).</a>
    <li class='indexItem indexItem2'><a href='#$dh-&#62;p([_$p_])'>$dh-&#62;p([ $p ])</a>
    <li class='indexItem indexItem2'><a href='#$dh-&#62;g([_$g_])'>$dh-&#62;g([ $g ])</a>
    <li class='indexItem indexItem2'><a href='#$dh-&#62;generate_keys'>$dh-&#62;generate_keys</a>
    <li class='indexItem indexItem2'><a href='#$dh-&#62;compute_secret(_$public_key_)'>$dh-&#62;compute_secret( $public_key )</a>
    <li class='indexItem indexItem2'><a href='#$dh-&#62;priv_key([_$priv_key_])'>$dh-&#62;priv_key([ $priv_key ])</a>
    <li class='indexItem indexItem2'><a href='#$dh-&#62;pub_key'>$dh-&#62;pub_key</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#AUTHOR_&#38;_COPYRIGHT'>AUTHOR &#38; COPYRIGHT</a>
</ul>
</div>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME <img alt='^' src='http://st.pimg.net/tucs/img/up.gif'></a></h1>

<p>Crypt::DH - Diffie-Hellman key exchange system</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS <img alt='^' src='http://st.pimg.net/tucs/img/up.gif'></a></h1>

<pre class="sh_perl">    use Crypt::DH;
    my $dh = Crypt::DH-&#62;new;
    $dh-&#62;g($g);
    $dh-&#62;p($p);

    ## Generate public and private keys.
    $dh-&#62;generate_keys;

    $my_pub_key = $dh-&#62;pub_key;

    ## Send $my_pub_key to &#34;other&#34; party, and receive &#34;other&#34;
    ## public key in return.

    ## Now compute shared secret from &#34;other&#34; public key.
    my $shared_secret = $dh-&#62;compute_secret( $other_pub_key );</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION <img alt='^' src='http://st.pimg.net/tucs/img/up.gif'></a></h1>

<p><i>Crypt::DH</i> is a Perl implementation of the Diffie-Hellman key exchange system. Diffie-Hellman is an algorithm by which two parties can agree on a shared secret key, known only to them. The secret is negotiated over an insecure network without the two parties ever passing the actual shared secret, or their private keys, between them.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="THE_ALGORITHM"
>THE ALGORITHM <img alt='^' src='http://st.pimg.net/tucs/img/up.gif'></a></h1>

<p>The algorithm generally works as follows: Party A and Party B choose a property <i>p</i> and a property <i>g</i>; these properties are shared by both parties. Each party then computes a random private key integer <i>priv_key</i>, where the length of <i>priv_key</i> is at most (number of bits in <i>p</i>) - 1. Each party then computes a public key based on <i>g</i>, <i>priv_key</i>, and <i>p</i>; the exact value is</p>

<pre class="sh_perl">    g ^ priv_key mod p</pre>

<p>The parties exchange these public keys.</p>

<p>The shared secret key is generated based on the exchanged public key, the private key, and <i>p</i>. If the public key of Party B is denoted <i>pub_key_B</i>, then the shared secret is equal to</p>

<pre class="sh_perl">    pub_key_B ^ priv_key mod p</pre>

<p>The mathematical principles involved insure that both parties will generate the same shared secret key.</p>

<p>More information can be found in PKCS #3 (Diffie-Hellman Key Agreement Standard):</p>

<pre class="sh_perl">    <a href="http://www.rsasecurity.com/rsalabs/pkcs/pkcs-3/" class="podlinkurl"
>http://www.rsasecurity.com/rsalabs/pkcs/pkcs-3/</a></pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="USAGE"
>USAGE <img alt='^' src='http://st.pimg.net/tucs/img/up.gif'></a></h1>

<p><i>Crypt::DH</i> implements the core routines needed to use Diffie-Hellman key exchange. To actually use the algorithm, you&#39;ll need to start with values for <i>p</i> and <i>g</i>; <i>p</i> is a large prime, and <i>g</i> is a base which must be larger than 0 and less than <i>p</i>.</p>

<p><i>Crypt::DH</i> uses <i>Math::BigInt</i> internally for big-integer calculations. All accessor methods (<i>p</i>, <i>g</i>, <i>priv_key</i>, and <i>pub_key</i>) thus return <i>Math::BigInt</i> objects, as does the <i>compute_secret</i> method. The accessors, however, allow setting with a scalar decimal string, hex string (^0x), Math::BigInt object, or Math::Pari object (for backwards compatibility).</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$dh_=_Crypt::DH-&#62;new([_%param_])."
>$dh = Crypt::DH-&#62;new([ %param ]).</a></h2>

<p>Constructs a new <i>Crypt::DH</i> object and returns the object. <i>%param</i> may include none, some, or all of the keys <i>p</i>, <i>g</i>, and <i>priv_key</i>.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$dh-&#62;p([_$p_])"
>$dh-&#62;p([ $p ])</a></h2>

<p>Given an argument <i>$p</i>, sets the <i>p</i> parameter (large prime) for this <i>Crypt::DH</i> object.</p>

<p>Returns the current value of <i>p</i>. (as a Math::BigInt object)</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$dh-&#62;g([_$g_])"
>$dh-&#62;g([ $g ])</a></h2>

<p>Given an argument <i>$g</i>, sets the <i>g</i> parameter (base) for this <i>Crypt::DH</i> object.</p>

<p>Returns the current value of <i>g</i>.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$dh-&#62;generate_keys"
>$dh-&#62;generate_keys</a></h2>

<p>Generates the public and private key portions of the <i>Crypt::DH</i> object, assuming that you&#39;ve already filled <i>p</i> and <i>g</i> with appropriate values.</p>

<p>If you&#39;ve provided a priv_key, it&#39;s used, otherwise a random priv_key is created using either Crypt::Random (if already loaded), or /dev/urandom, or Perl&#39;s rand, in that order.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$dh-&#62;compute_secret(_$public_key_)"
>$dh-&#62;compute_secret( $public_key )</a></h2>

<p>Given the public key <i>$public_key</i> of Party B (the party with which you&#39;re performing key negotiation and exchange), computes the shared secret key, based on that public key, your own private key, and your own large prime value (<i>p</i>).</p>

<p>The historical method name &#34;compute_key&#34; is aliased to this for compatibility.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$dh-&#62;priv_key([_$priv_key_])"
>$dh-&#62;priv_key([ $priv_key ])</a></h2>

<p>Returns the private key. Given an argument <i>$priv_key</i>, sets the <i>priv_key</i> parameter for this <i>Crypt::DH</i> object.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$dh-&#62;pub_key"
>$dh-&#62;pub_key</a></h2>

<p>Returns the public key.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR_&#38;_COPYRIGHT"
>AUTHOR &#38; COPYRIGHT <img alt='^' src='http://st.pimg.net/tucs/img/up.gif'></a></h1>

<p>Benjamin Trott, ben@rhumba.pair.com</p>

<p>Brad Fitzpatrick, brad@danga.com</p>

<p>Except where otherwise noted, Crypt::DH is Copyright 2001 Benjamin Trott. All rights reserved. Crypt::DH is free software; you may redistribute it and/or modify it under the same terms as Perl itself.</p>

</div>
<!-- This should probably be put in the <div class="footer"></div> -->
<script type="text/javascript">
    $(document).ready(function(){
        var startingStyle = $.cookie('css') ? $.cookie('css') : 'http://st.pimg.net/tucs/css/sh_none.min.css';
        $.fn.styleSwitch(startingStyle);
        $("#styleswitch").val(startingStyle);
        sh_highlightDocument();
        $("#styleswitch").bind(($.browser.msie ? "click" : "change"), function() {
            $.fn.styleSwitch($(this).val());
        });
    });
</script>
<div class="styleswitch">
    syntax highlighting:
    <select id="styleswitch">
        <option value="http://st.pimg.net/tucs/css/sh_none.min.css">no syntax highlighting</option>
        <option value="http://st.pimg.net/tucs/css/sh_acid.min.css">acid</option>
        <option value="http://st.pimg.net/tucs/css/sh_berries-dark.min.css">berries-dark</option>
        <option value="http://st.pimg.net/tucs/css/sh_berries-light.min.css">berries-light</option>
        <option value="http://st.pimg.net/tucs/css/sh_bipolar.min.css">bipolar</option>
        <option value="http://st.pimg.net/tucs/css/sh_blacknblue.min.css">blacknblue</option>
        <option value="http://st.pimg.net/tucs/css/sh_bright.min.css">bright</option>
        <option value="http://st.pimg.net/tucs/css/sh_contrast.min.css">contrast</option>
        <option value="http://st.pimg.net/tucs/css/sh_cpan.min.css">cpan</option>
        <option value="http://st.pimg.net/tucs/css/sh_darkblue.min.css">darkblue</option>
        <option value="http://st.pimg.net/tucs/css/sh_darkness.min.css">darkness</option>
        <option value="http://st.pimg.net/tucs/css/sh_desert.min.css">desert</option>
        <option value="http://st.pimg.net/tucs/css/sh_dull.min.css">dull</option>
        <option value="http://st.pimg.net/tucs/css/sh_easter.min.css">easter</option>
        <option value="http://st.pimg.net/tucs/css/sh_emacs.min.css">emacs</option>
        <option value="http://st.pimg.net/tucs/css/sh_golden.min.css">golden</option>
        <option value="http://st.pimg.net/tucs/css/sh_greenlcd.min.css">greenlcd</option>
        <option value="http://st.pimg.net/tucs/css/sh_ide-anjuta.min.css">ide-anjuta</option>
        <option value="http://st.pimg.net/tucs/css/sh_ide-codewarrior.min.css">ide-codewarrior</option>
        <option value="http://st.pimg.net/tucs/css/sh_ide-devcpp.min.css">ide-devcpp</option>
        <option value="http://st.pimg.net/tucs/css/sh_ide-eclipse.min.css">ide-eclipse</option>
        <option value="http://st.pimg.net/tucs/css/sh_ide-kdev.min.css">ide-kdev</option>
        <option value="http://st.pimg.net/tucs/css/sh_ide-msvcpp.min.css">ide-msvcpp</option>
        <option value="http://st.pimg.net/tucs/css/sh_kwrite.min.css">kwrite</option>
        <option value="http://st.pimg.net/tucs/css/sh_matlab.min.css">matlab</option>
        <option value="http://st.pimg.net/tucs/css/sh_navy.min.css">navy</option>
        <option value="http://st.pimg.net/tucs/css/sh_nedit.min.css">nedit</option>
        <option value="http://st.pimg.net/tucs/css/sh_neon.min.css">neon</option>
        <option value="http://st.pimg.net/tucs/css/sh_night.min.css">night</option>
        <option value="http://st.pimg.net/tucs/css/sh_pablo.min.css">pablo</option>
        <option value="http://st.pimg.net/tucs/css/sh_peachpuff.min.css">peachpuff</option>
        <option value="http://st.pimg.net/tucs/css/sh_print.min.css">print</option>
        <option value="http://st.pimg.net/tucs/css/sh_rand01.min.css">rand01</option>
	<option value="http://st.pimg.net/tucs/css/sh_solarized-dark.min.css">solarized-dark</option>
	<option value="http://st.pimg.net/tucs/css/sh_solarized-light.min.css">solarized-light</option>
        <option value="http://st.pimg.net/tucs/css/sh_style.min.css">style</option>
        <option value="http://st.pimg.net/tucs/css/sh_the.min.css">the</option>
        <option value="http://st.pimg.net/tucs/css/sh_typical.min.css">typical</option>
        <option value="http://st.pimg.net/tucs/css/sh_vampire.min.css">vampire</option>
        <option value="http://st.pimg.net/tucs/css/sh_vim-dark.min.css">vim-dark</option>
        <option value="http://st.pimg.net/tucs/css/sh_vim.min.css">vim</option>
        <option value="http://st.pimg.net/tucs/css/sh_whatis.min.css">whatis</option>
        <option value="http://st.pimg.net/tucs/css/sh_whitengrey.min.css">whitengrey</option>
        <option value="http://st.pimg.net/tucs/css/sh_zellner.min.css">zellner</option>
    </select>
</div>



<div class="footer"><div class="cpanstats">78269 Uploads, 24722 Distributions
105999 Modules, 9649 Uploaders
</div>
hosted by <a href="http://www.yellowbot.com">YellowBot</a><br/>
<a href="http://www.yellowbot.com"><img alt="do. tag. write. share." src="http://st.pimg.net/tucs/img/yellowbot_logo.gif"></a>
</div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript" src="http://ipv4.v6test.develooper.com/js/v1/v6test.js"></script>

<script type="text/javascript">
   // v6.target = '';
   if (!v6.target) { v6.only_once = true }
   v6.site = '7A0D89A6-2B82-11DF-B9DA-F61CBD13F020';
   v6.api_server = 'http://ipv4.v6test.develooper.com';
   try {
     v6.test();
   } catch(err) {}
</script>
<script type="text/javascript">
  $(document).ready(function(){
    $("a[href^=http:]").click(function(){
      var href = $(this).attr('href');
      var m = href.match('\/\/([^\/:]+)');
      _gaq.push(['_trackEvent','External',m[1],'Module']);
    });
    $("a[href^=/CPAN/]").click(function(){
      var href = $(this).attr('href');
      _gaq.push(['_trackEvent','Download',href,'Module']);
    });
  });
</script>
<!-- Fri Apr 27 17:37:48 2012 GMT (0.0984718799591064) @cpansearch1 -->
 </body>
</html>
